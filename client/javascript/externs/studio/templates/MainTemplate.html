<div class="container low-app-padding app_window works_line_studio col-xs-12" id="FormBuilder">
    <!--Composants-->
    <div id="studio_container">
        <div class="col-xs-3 low-padding" id="first-Layout">
            <!--Formulaire-->
            <div data-app-json-loader></div>
            <!--<div data-app-dev-tools></div>-->
            <!--Definition-->
            <div data-app-element-form></div>
        </div>
        <div class="col-xs-6 low-padding" id="third-Layout" >
            <!--Visualiseur-->
            <div data-app-visualizer></div>
        </div>
        <div class="col-xs-3 low-padding" id="second-Layout">
            <!--Paramètres publiés-->
            <div data-app-form-tools></div>
        </div>
        <!--Modale source de donnees-->
        <div id="studio-datasource-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Element.Component.Select.Datasources}}</h4>
                    </div>
                    <div class="modal-body modal-body-big">
                        <div class="row">
                            <div class="col-sm-6">
                                <!--objet-->
                                <div ng-show="selectedDatasource.dataType === 'text'">
                                    <h4>{{::ctrl.text.Element.Component.Select.Select_Text}}</h4>
                                    <form class="element-margin form-group-xs">
                                        <!--ID-->
                                        <div ng-show="false" class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">ID</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.id" disabled>
                                        </div>
                                        <!--Nom-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.name" disabled>
                                        </div>
                                        <!--Description-->
                                        <!--<div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.description" disabled>
                                        </div>-->
                                        <!--Contenu-->
                                        <label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Content}}"></label>
                                        <div>
                                            <i>{{::ctrl.text.Element.Component.Select.Content_description}}</i>
                                        </div>                                    
                                        <textarea style="width: 398px; height: 132px; cursor: not-allowed" ng-model="selectedDatasource.options_model" disabled></textarea>
                                    </form>
                                </div>
                                <!--valeurs d'une table-->
                                <div ng-show="selectedDatasource.dataType === 'tableValue'">
                                    <h4>{{::ctrl.text.Element.Component.Select.Select_Table_Values}}</h4>
                                    <form class="element-margin form-group-xs">
                                        <!--ID-->
                                        <div ng-show="false" class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">ID</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.id" disabled>
                                        </div>
                                        <!--Name-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.name" disabled>
                                        </div>
                                        <!--Description-->
                                        <!--<div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.description" disabled>
                                        </div>-->
                                        <!--Database-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.database" disabled>
                                        </div>
                                        <!--Schema-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.schema" disabled>
                                        </div>
                                        <!--Table-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.table" disabled>
                                        </div>
                                    </form>
                                </div>
                                <!--Service web-->
                                <div ng-show="selectedDatasource.dataType === 'webService'">
                                    <h4>{{::ctrl.text.Element.Component.Select.Select_Webservice}}</h4>
                                    <form class="element-margin form-group-xs">
                                        <!--ID-->
                                        <div ng-show="false" class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">ID</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.id" disabled>
                                        </div>
                                        <!--name-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.name" disabled>
                                        </div>
                                        <!--description-->
                                        <!--<div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.description" disabled>
                                        </div>-->
                                        <!--web service-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Webservice}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.webservice.name" disabled>
                                        </div>
                                        <!--ressource-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Ressource}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.ressource.name" disabled>
                                        </div>
                                    </form>
                                </div>
                                <!--Objet métier-->
                                <div ng-show="selectedDatasource.dataType === 'businessObject'">
                                    <h4>{{::ctrl.text.Element.Component.Select.BusinessObject}}</h4>
                                    <form class="element-margin form-group-xs">
                                        <!--ID-->
                                        <div ng-show="false" class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">ID</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.id" disabled>
                                        </div>
                                        <!--name-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.name" disabled>
                                        </div>
                                        <!--description-->
                                        <!--<div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.description" disabled>
                                        </div>-->
                                        <!--Objet métier-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.businessObject.business_object_id" disabled>
                                        </div>
                                        <!--requête-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject_Request}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.businessObjectRequest" disabled>
                                        </div>
                                    </form>
                                </div>
                                <!--Base de données externe-->
                                <div ng-show="selectedDatasource.dataType === 'externalDatabase'">
                                    <h4>{{::ctrl.text.Element.Component.Select.Select_External_Database}}</h4>
                                    <form class="element-margin form-group-xs">
                                        <!--ID-->
                                        <div ng-show="false" class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">ID</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.id" disabled>
                                        </div>
                                        <!--Name-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.name" disabled>
                                        </div>
                                        <!--Description-->
                                        <!--<div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.description" disabled>
                                        </div>-->
                                        <!--Server-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Server}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.server" disabled>
                                        </div>
                                        <!--Port-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Port}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.port" disabled>
                                        </div>
                                        <!--SGBD-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.SGBD}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.sgbd" disabled>
                                        </div>
                                        <!--Login-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Login}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.login" disabled>
                                        </div>
                                        <!--Password-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Password}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.password" disabled>
                                        </div>                                    
                                        <!--Database-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.database" disabled>
                                        </div>
                                        <!--Schema-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.schema" disabled>
                                        </div>
                                        <!--Table-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                            <input type="text" class="form-control" ng-model="selectedDatasource.parameters.table" disabled>
                                        </div>
                                        <!--Filtre-->
                                        <div class="input-group element-margin input-group-xs width-100">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Filter}}</label>
                                            <input type="text" class="form-control" placeholder="ex: name='Public'" ng-model="selectedDatasource.parameters.filter" disabled>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div style="height: 40px">
                                    <button class="btn btn-primary right margin-sides-5" ng-click="ctrl.removeSelectedSource()">{{::ctrl.text.Element.Component.Select.Delete}}</button>
                                    <button class="btn btn-primary right margin-sides-5" ng-click="ctrl.showNewSourceModal()">{{::ctrl.text.Element.Component.Select.Add}}</button>
                                    <button class="btn btn-primary right margin-sides-5" ng-click="ctrl.showEditSourceModal()">{{::ctrl.text.Element.Component.Select.Edit}}</button>
                                </div>
                                <div>
                                    <div id="grid-studio-datasources" ui-grid="studioDatasourcesGridOptions" ui-grid-selection class="grid" style="width: 425px;  height: 350px;"></div>
                                </div>
                                <div style="margin-top: 8px">
                                    <button class="btn btn-primary right margin-sides-5" data-dismiss="modal">{{::ctrl.text.Element.Component.Select.Save}}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>  
        </div>
        <!--Modale édition source de donnees-->
        <div id="studio-datasource-edit-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Element.Component.Select.Datasources}}</h4>
                    </div>
                    <div class="modal-body modal-body-big">
                        <div class="row">
                            <form ng-submit="ctrl.saveDatasource(editedDatasource)">
                                <!--ID-->
                                <div ng-show="false" class="element-margin form-group-xxs col-xs-12">
                                    <label class="control-label">ID</label>
                                    <input type="text" class="form-control element-margin"
                                           ng-model="editedDatasource.id"
                                           required>
                                </div>
                                <!--Nom-->
                                <div class="element-margin form-group-xxs col-xs-12">
                                    <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                    <input type="text" class="form-control element-margin"
                                           ng-model="editedDatasource.name"
                                           required>
                                </div>
                                <!--Description-->
                                <!--<div class="input-group element-margin input-group-xs width-100">
                                    <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                    <input type="text" class="form-control"
                                           ng-model="editedDatasource.description">
                                       </div>-->
                                <!--text-->
                                <div id="textDatasourceAddform" class="col-xs-12" ng-if="editedDatasource.dataType === 'text'">
                                    <!--Contenu-->
                                    <label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Content}}"></label>
                                    <div>
                                        <i>{{::ctrl.text.Element.Component.Select.Content_description}}</i>
                                    </div>                                
                                    <ui-codemirror 
                                        id="textOptionsCodeMirrorEdit"
                                        ui-refresh="refresh"
                                        ui-codemirror-opts="editorOptions" 
                                        ng-model="editedDatasource.options_model"
                                        ng-change="ctrl.updateDatasourceTextContent(editedDatasource)"></ui-codemirror>
                                </div>
                                <!--tableValue-->
                                <div id="tableValueDatasourceAddform" ng-if="editedDatasource.dataType === 'tableValue'">
                                    <!--Base-->
                                    <div class="element-margin form-group-xxs col-xs-5">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                        <div class="row">
                                            <div class="col-sm-8">
                                                <select type="text" class="form-control"
                                                        ng-options="database.database for database in databases| orderBy: 'database' track by database.database"  
                                                        ng-model="$parent.databaseSelected"
                                                        ng-change="editedDatasource.parameters.database = databaseSelected.database" required></select>
                                            </div>
                                            <div class="col-sm-4">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.setLocalDatabaseSchemas(editedDatasource.parameters.database)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Schema_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Schema-->
                                    <div class="element-margin form-group-xxs col-xs-4">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                        <div class="row">
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control"
                                                       ng-show="schemas.length === 0"
                                                       ng-model="editedDatasource.parameters.schema">
                                                <select type="text" class="form-control"
                                                        ng-show="schemas.length > 0"
                                                        ng-options="schema.schema_name for schema in schemas| orderBy: 'schema_name' track by schema.schema_name" 
                                                        ng-model="$parent.schemaSelected"
                                                        ng-change="editedDatasource.parameters.schema = schemaSelected.schema_name" required></select>
                                            </div>
                                            <div class="col-sm-4">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.reloadTablesList(editedDatasource.parameters.schema, editedDatasource.parameters.database)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Table_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Table-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <input type="text" class="form-control"
                                                       ng-show="tables.length === 0"
                                                       ng-model="editedDatasource.parameters.table">
                                                <select class="form-control"
                                                        ng-show="tables.length > 0"
                                                        ng-options="table.table_name for table in tables| orderBy: 'table_name' track by table.table_name"
                                                        ng-model="$parent.tableSelected"
                                                        ng-change="editedDatasource.parameters.table = tableSelected.table_name"
                                                        required>      
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Filter-->
                                    <div class="row">
                                        <div class="margin-sides-10 col-xs-12">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Filter}}</label>
                                        </div>
                                        <div class="element-margin form-group-xxs col-xs-12">
                                            <div class="row">
                                                <div class="col-xs-3" style="padding-right:0px">
                                                    <div class="element-margin form-group-xxs col-xs-10">
                                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Relation}}</label>
                                                        <select class="form-control" ng-model="editedDatasource.parameters.filter.relation">
                                                            <option>AND</option>
                                                            <option>OR</option>
                                                        </select>
                                                    </div>
                                                    <div class="element-margin form-group-xxs col-xs-2">
                                                        <br>
                                                        <div class="btn btn-primary btn-xs addfields" ng-click="ctrl.addNewFilterOperator(editedDatasource)"> + </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-9" style="padding-left:0px">
                                                    <div ng-repeat = " (i, operator) in editedDatasource.parameters.filter.operators track by $index">
                                                        <div class="element-margin form-group-xxs col-xs-1">
                                                            <br>
                                                            <div class="btn btn-danger btn-xs addfields" ng-click="ctrl.removeFilterOperator(editedDatasource, operator)"> - </div>
                                                        </div>
                                                        <div  class="element-margin form-group-xxs col-xs-4">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.KeyValue}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="editedDatasource.parameters.filter.operators[i].column" >
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-2">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.CompareOperator}}</label>
                                                            <select class="form-control" id="sel1" ng-model="editedDatasource.parameters.filter.operators[i].compare_operator" >
                                                                <option>=</option>
                                                                <option>!=</option>
                                                                <option><</option>
                                                                <option>></option>
                                                                <option>IN</option>
                                                                <option>LIKE</option>
                                                                <option>NOT NULL</option>
                                                            </select>
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-5">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Value}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="editedDatasource.parameters.filter.operators[i].value" >
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--webService-->
                                <div id="webServiceDatasourceAddform" ng-if="editedDatasource.dataType === 'webService'">
                                    <!--Webservice-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Webservice}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="editedDatasource.webservice"
                                                ng-change="ctrl.updateRessources(editedDatasource.webservice)"  
                                                ng-options="webservice.name for webservice in webservices track by webservice.name"
                                                required></select>
                                    </div>
                                    <!--Ressource-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Ressource}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="editedDatasource.ressource" 
                                                ng-options="ressource.name for ressource in ressources track by ressource.name"
                                                required></select>
                                    </div>
                                </div>
                                <!--businessObject-->
                                <div id="businessObjectDatasourceAddform" ng-if="editedDatasource.dataType === 'businessObject'">
                                    <!--Business Object-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="editedDatasource.businessObject" 
                                                ng-options="businessObjects.business_object_id for businessObjects in businessObjects track by businessObjects.business_object_id"
                                                required></select>
                                    </div>
                                    <!--Formulaire-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject_Request}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="editedDatasource.businessObjectRequest">
                                            <option value="form">Form</option>
                                            <option value="summary">SQL Summary</option>
                                            <option value="list">SQL List</option>
                                        </select>
                                    </div>
                                    <textarea style="width:calc(100% - 30px);height: 63px;margin-left: 15px;margin-right: 15px;" ng-model="editedDatasource.businessObject['sql_' + editedDatasource.businessObjectRequest]" disabled></textarea>
                                </div>
                                <!--externalDatabase-->
                                <div id="externalDatabaseDatasourceAddform" ng-if="editedDatasource.dataType === 'externalDatabase'">
                                    <!--Serveur-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Server}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="editedDatasource.parameters.server"
                                               required>
                                    </div>
                                    <!--Port-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Port}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="editedDatasource.parameters.port"
                                               required>
                                    </div>
                                    <!--SGBD-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.SGBD}}</label>
                                        <select class="form-control" ng-model="editedDatasource.parameters.sgbd" required>
                                            <option value="pgsql" label="Postgres">Postgres</option>     
                                            <option value="oci" label="Oracle">Oracle</option>  
                                        </select>
                                    </div>
                                    <!--Login-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Login}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="editedDatasource.parameters.login"
                                               required>
                                    </div>
                                    <!--Password-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Password}}</label>
                                        <input type="password" class="form-control"
                                               ng-model="editedDatasource.parameters.password"
                                               required>
                                    </div>
                                    <!--Database-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="editedDatasource.parameters.database"
                                               required>
                                    </div>
                                    <!--Schema-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="editedDatasource.parameters.schema"
                                               required>
                                    </div>
                                    <!--Liste des tables-->
                                    <div class="col-xs-12 form-group-xxs ">
                                        <label class=" element-margin control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                        <div class="row">
                                            <div class="col-sm-9">

                                                <input type="text" class="form-control element-margin"
                                                       ng-show="!aExternalDatabaseTables.length > 0"
                                                       ng-model="editedDatasource.parameters.table"
                                                       required>
                                                <select class="form-control element-margin"
                                                        ng-show="aExternalDatabaseTables.length > 0"
                                                        ng-change="aExternalDatabaseColumns.length = 0"
                                                        ng-model="editedDatasource.parameters.table">
                                                    <option ng-repeat="table in aExternalDatabaseTables" ng-value="table">{{table}}</option>
                                                </select>

                                            </div>
                                            <div class="col-sm-3">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.getExternalDatabaseTables(editedDatasource)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Table_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Filter-->
                                    <div class="row">
                                        <div class="margin-sides-10 col-xs-12">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Filter}}</label>
                                        </div>
                                        <div class="element-margin form-group-xxs col-xs-12">
                                            <div class="row">
                                                <div class="col-xs-3" style="padding-right:0px">
                                                    <div class="element-margin form-group-xxs col-xs-10">
                                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Relation}}</label>
                                                        <select class="form-control" ng-model="editedDatasource.parameters.filter.relation">
                                                            <option>AND</option>
                                                            <option>OR</option>
                                                        </select>
                                                    </div>
                                                    <div class="element-margin form-group-xxs col-xs-2">
                                                        <br>
                                                        <div class="btn btn-primary btn-xs addfields" ng-click="ctrl.addNewFilterOperator(editedDatasource)"> + </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-9" style="padding-left:0px">
                                                    <div ng-repeat = " (i, operator) in editedDatasource.parameters.filter.operators track by $index">
                                                        <div class="element-margin form-group-xxs col-xs-1">
                                                            <br>
                                                            <div class="btn btn-danger btn-xs addfields" ng-click="ctrl.removeFilterOperator(editedDatasource, operator)"> - </div>
                                                        </div>
                                                        <div  class="element-margin form-group-xxs col-xs-4">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.KeyValue}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="editedDatasource.parameters.filter.operators[i].column" >
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-2">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.CompareOperator}}</label>
                                                            <select class="form-control" id="sel1" ng-model="editedDatasource.parameters.filter.operators[i].compare_operator" >
                                                                <option>=</option>
                                                                <option>!=</option>
                                                                <option><</option>
                                                                <option>></option>
                                                                <option>IN</option>
                                                                <option>LIKE</option>
                                                                <option>NOT NULL</option>
                                                            </select>
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-5">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Value}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="editedDatasource.parameters.filter.operators[i].value" >
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--Fenêtre de test-->
                                <div class="col-xs-12" id="Layout_Preview">
                                    <!--Text-->
                                    <div ng-show="editedDatasource.dataType === 'text'">
                                        <div><label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Result}}"></label></div>
                                        <div class="row">
                                            <div class="form-group-xxs col-xs-6">
                                                <select class="element-margin form-control"
                                                        ng-model="editedDatasource.test_result"
                                                        ng-options="option.label for option in editedDatasource.result_options track by option.value">
                                                </select>
                                            </div>
                                            <div class="col-xs-3">
                                                {{editedDatasource.test_result.value}}
                                            </div>
                                            <div class="col-xs-3">
                                                <button ng-if="editedDatasource.dataType === 'tableValue' || editedDatasource.dataType === 'webService' || editedDatasource.dataType === 'businessObject' || editedDatasource.dataType === 'externalDatabase' || editedDatasource.dataType === 'text'" 
                                                        type="submit" 
                                                        class="btn btn-primary right">{{::ctrl.text.Element.Component.Select.Save}}</button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Valeurs d'une table-->
                                    <div ng-show="editedDatasource.dataType === 'tableValue' || editedDatasource.dataType === 'webService' || editedDatasource.dataType === 'businessObject' || editedDatasource.dataType === 'externalDatabase'">
                                        <!--Test-->
                                        <div>
                                            <button type="button" class="btn btn-success element-margin" ng-click="ctrl.testDatasource(editedDatasource, 'studio-datasource-edit-modal')">Test</button>
                                            <button ng-if="editedDatasource.dataType === 'tableValue' || editedDatasource.dataType === 'webService' || editedDatasource.dataType === 'businessObject' || editedDatasource.dataType === 'externalDatabase' || editedDatasource.dataType === 'text'" 
                                                    type="submit" 
                                                    class="btn btn-primary right">{{::ctrl.text.Element.Component.Select.Save}}</button>
                                        </div>
                                        <div><label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Result}}"></label></div>
                                        <div>
                                            <div id="grid-studio-webService-test" ui-grid="studioEditModalTestGridOptions" style="width:856px;height: 350px;" class="grid element-margin"></div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>  
        </div>
        <!--Modale ajout source de données-->
        <div id="studio-datasource-add-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Element.Component.Select.Datasources}}</h4>
                    </div>
                    <div class="modal-body modal-body-big">
                        <div class="row">
                            <div class="element-margin form-group-xs col-sm-6">
                                <label for="Element_Form_Datasource_Select" id="Element_Form_Datasource_label" class="control-label">{{::ctrl.text.Element.Component.Select.Select_Type}}</label>
                                <span class="form-field-label-tooltip" id="typeSourceTooltip" data-trigger="hover"></span>
                                <select class="form-control element-margin"
                                        ng-change="ctrl.loadDatasourceDefaultValues(newSource)"
                                        ng-model="newSource.dataType">
                                    <option value="text">{{::ctrl.text.Element.Component.Select.Select_Text}}</option>
                                    <option value="tableValue">{{::ctrl.text.Element.Component.Select.Select_Table_Values}}</option>
                                    <option value="webService">{{::ctrl.text.Element.Component.Select.Select_Webservice}}</option>
                                    <option ng-if="applicationName !== 'gtf'" value="businessObject">{{::ctrl.text.Element.Component.Select.Select_Business_Object}}</option>
                                    <option value="externalDatabase">{{::ctrl.text.Element.Component.Select.Select_External_Database}}</option>
                                </select>
                                <hr>
                            </div>
                        </div>
                        <div class="row">
                            <form ng-submit="ctrl.addSource(newSource)">
                                <!--ID-->
                                <div ng-show="false" class="element-margin form-group-xxs col-xs-12">
                                    <label class="control-label">ID</label>
                                    <input type="text" class="form-control element-margin"
                                           ng-model="newSource.id"
                                           required>
                                </div>
                                <!--Nom-->
                                <div class="element-margin form-group-xxs col-xs-12">
                                    <label class="control-label">{{::ctrl.text.Element.Component.Select.Name}}</label>
                                    <input type="text" class="form-control element-margin"
                                           ng-model="newSource.name"
                                           required>
                                </div>
                                <!--Description-->
                                <!--<div class="input-group element-margin input-group-xs width-100">
                                    <label class="control-label">{{::ctrl.text.Element.Component.Select.Description}}</label>
                                    <input type="text" class="form-control"
                                           ng-model="newSource.description">
                                       </div>-->
                                <!--text-->
                                <div id="textDatasourceAddform" class="col-xs-12" ng-if="newSource.dataType === 'text'">
                                    <!--Contenu-->
                                    <label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Content}}"></label>
                                    <div>
                                        <i>{{::ctrl.text.Element.Component.Select.Content_description}}</i>
                                    </div>                                
                                    <ui-codemirror 
                                        id="textOptionsCodeMirrorAdd"
                                        ui-refresh="newSource.dataType === 'text'"
                                        ui-codemirror-opts="editorOptions" 
                                        ng-model="newSource.options_model"
                                        ng-change="ctrl.updateDatasourceTextContent(newSource)"></ui-codemirror>
                                </div>
                                <!--tableValue-->
                                <div id="tableValueDatasourceAddform" ng-if="newSource.dataType === 'tableValue'">
                                    <!--DatabaseV2-->
                                    <div class="element-margin form-group-xxs col-xs-5">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                        <div class="row">
                                            <div class="col-sm-8">
                                                <select type="text" class="form-control"
                                                        ng-init="ctrl.setLocalDatabases(newSource.parameters.database)"
                                                        ng-options="database.database for database in databases| orderBy: 'database' track by database.database"  
                                                        ng-model="$parent.databaseSelected"
                                                        ng-change="newSource.parameters.database = databaseSelected.database" required></select>
                                            </div>
                                            <div class="col-sm-4">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.setLocalDatabaseSchemas(newSource.parameters.database)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Schema_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Schema-->
                                    <div class="element-margin form-group-xxs col-xs-4">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                        <div class="row">
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control"
                                                       ng-show="schemas.length === 0"
                                                       ng-model="newSource.parameters.schema">
                                                <select type="text" class="form-control"
                                                        ng-show="schemas.length > 0"
                                                        ng-options="schema.schema_name for schema in schemas| orderBy: 'schema_name' track by schema.schema_name" 
                                                        ng-model="$parent.schemaSelected"
                                                        ng-change="newSource.parameters.schema = schemaSelected.schema_name" required></select>
                                            </div>
                                            <div class="col-sm-4">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.reloadTablesList(newSource.parameters.schema, newSource.parameters.database)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Table_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Table-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <input type="text" class="form-control"
                                                       ng-show="tables.length === 0"
                                                       ng-model="newSource.parameters.table">
                                                <select class="form-control"
                                                        ng-show="tables.length > 0"
                                                        ng-options="table.table_name for table in tables| orderBy: 'table_name' track by table.table_name"
                                                        ng-model="$parent.tableSelected"
                                                        ng-change="newSource.parameters.table = tableSelected.table_name"
                                                        required>      
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Filter-->
                                    <div class="row">
                                        <div class="margin-sides-10 col-xs-12">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Filter}}</label>
                                        </div>
                                        <div class="element-margin form-group-xxs col-xs-12">
                                            <div class="row">
                                                <div class="col-xs-3" style="padding-right:0px">
                                                    <div class="element-margin form-group-xxs col-xs-10">
                                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Relation}}</label>
                                                        <select class="form-control" ng-model="newSource.parameters.filter.relation">
                                                            <option>AND</option>
                                                            <option>OR</option>
                                                        </select>
                                                    </div>
                                                    <div class="element-margin form-group-xxs col-xs-2">
                                                        <br>
                                                        <div class="btn btn-primary btn-xs addfields" ng-click="ctrl.addNewFilterOperator(newSource)"> + </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-9" style="padding-left:0px">
                                                    <div ng-repeat = " (i, operator) in newSource.parameters.filter.operators track by $index">
                                                        <div class="element-margin form-group-xxs col-xs-1">
                                                            <br>
                                                            <div class="btn btn-danger btn-xs addfields" ng-click="ctrl.removeFilterOperator(newSource, operator)"> - </div>
                                                        </div>
                                                        <div  class="element-margin form-group-xxs col-xs-4">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.KeyValue}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="newSource.parameters.filter.operators[i].column" >
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-2">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.CompareOperator}}</label>
                                                            <select class="form-control" id="sel1" ng-model="newSource.parameters.filter.operators[i].compare_operator" >
                                                                <option>=</option>
                                                                <option>!=</option>
                                                                <option><</option>
                                                                <option>></option>
                                                                <option>IN</option>
                                                                <option>LIKE</option>
                                                                <option>NOT NULL</option>
                                                            </select>
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-5">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Value}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="newSource.parameters.filter.operators[i].value" >
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--webService-->
                                <div id="webServiceDatasourceAddform" ng-if="newSource.dataType === 'webService'">
                                    <!--Webservice-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Webservice}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="newSource.webservice"
                                                ng-change="ctrl.updateRessources(newSource.webservice)"  
                                                ng-options="webservice.name for webservice in webservices track by webservice.name"
                                                required></select>
                                    </div>
                                    <!--Ressource-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Ressource}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="newSource.ressource" 
                                                ng-options="ressource.name for ressource in ressources track by ressource.name"
                                                required></select>
                                    </div>
                                </div>
                                <!--businessObject-->
                                <div id="businessObjectDatasourceAddform" ng-if="newSource.dataType === 'businessObject'">
                                    <!--Business Object-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="newSource.businessObject" 
                                                ng-options="businessObjects.business_object_id for businessObjects in businessObjects track by businessObjects.business_object_id"
                                                required></select>
                                    </div>
                                    <!--Formulaire-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.BusinessObject_Request}}</label>
                                        <select class="form-control element-margin"
                                                ng-model="newSource.businessObjectRequest">
                                            <option value="form">Form</option>
                                            <option value="summary">SQL Summary</option>
                                            <option value="list">SQL List</option>
                                        </select>
                                    </div>
                                    <textarea style="width:calc(100% - 30px);height: 63px;margin-left: 15px;margin-right: 15px;" ng-model="newSource.businessObject['sql_' + newSource.businessObjectRequest]" disabled></textarea>
                                </div>
                                <!--externalDatabase-->
                                <div id="externalDatabaseDatasourceAddform" ng-if="newSource.dataType === 'externalDatabase'">
                                    <!--Serveur-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Server}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="newSource.parameters.server"
                                               required>
                                    </div>
                                    <!--Port-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Port}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="newSource.parameters.port"
                                               required>
                                    </div>
                                    <!--SGBD-->
                                    <div class="element-margin form-group-xxs col-xs-3">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.SGBD}}</label>
                                        <select class="form-control" ng-model="newSource.parameters.sgbd" required>
                                            <option value="pgsql" label="Postgres">Postgres</option>     
                                            <option value="oci" label="Oracle">Oracle</option>  
                                        </select>
                                    </div>
                                    <!--Login-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Login}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="newSource.parameters.login"
                                               required>
                                    </div>
                                    <!--Password-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Password}}</label>
                                        <input type="password" class="form-control"
                                               ng-model="newSource.parameters.password"
                                               required>
                                    </div>
                                    <!--Database-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Database}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="newSource.parameters.database"
                                               required>
                                    </div>
                                    <!--Schema-->
                                    <div class="element-margin form-group-xxs col-xs-6">
                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Schema}}</label>
                                        <input type="text" class="form-control"
                                               ng-model="newSource.parameters.schema"
                                               required>
                                    </div>
                                    <!--Liste des tables-->
                                    <div class="col-xs-12 form-group-xxs ">
                                        <label class=" element-margin control-label">{{::ctrl.text.Element.Component.Select.Table}}</label>
                                        <div class="row">
                                            <div class="col-sm-9">

                                                <input type="text" class="form-control element-margin"
                                                       ng-show="!aExternalDatabaseTables.length > 0"
                                                       ng-model="newSource.parameters.table"
                                                       required>
                                                <select class="form-control element-margin"
                                                        ng-show="aExternalDatabaseTables.length > 0"
                                                        ng-change="aExternalDatabaseColumns.length = 0"
                                                        ng-model="newSource.parameters.table">
                                                    <option ng-repeat="table in aExternalDatabaseTables" ng-value="table">{{table}}</option>
                                                </select>

                                            </div>
                                            <div class="col-sm-3">
                                                <button type="button" class="btn btn-success form-control" ng-click="ctrl.getExternalDatabaseTables(newSource)">
                                                    <span class="glyphicon glyphicon-share-alt"></span> {{::ctrl.text.Element.Component.Select.Table_List}}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Filter-->
                                    <div class="row">
                                        <div class="margin-sides-10 col-xs-12">
                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Filter}}</label>
                                        </div>
                                        <div class="element-margin form-group-xxs col-xs-12">
                                            <div class="row">
                                                <div class="col-xs-3" style="padding-right:0px">
                                                    <div class="element-margin form-group-xxs col-xs-10">
                                                        <label class="control-label">{{::ctrl.text.Element.Component.Select.Relation}}</label>
                                                        <select class="form-control" ng-model="newSource.parameters.filter.relation">
                                                            <option>AND</option>
                                                            <option>OR</option>
                                                        </select>
                                                    </div>
                                                    <div class="element-margin form-group-xxs col-xs-2">
                                                        <br>
                                                        <div class="btn btn-primary btn-xs addfields" ng-click="ctrl.addNewFilterOperator(newSource)"> + </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-9" style="padding-left:0px">
                                                    <div ng-repeat = " (i, operator) in newSource.parameters.filter.operators track by $index">
                                                        <div class="element-margin form-group-xxs col-xs-1">
                                                            <br>
                                                            <div class="btn btn-danger btn-xs addfields" ng-click="ctrl.removeFilterOperator(newSource, operator)"> - </div>
                                                        </div>
                                                        <div  class="element-margin form-group-xxs col-xs-4">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.KeyValue}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="newSource.parameters.filter.operators[i].column" >
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-2">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.CompareOperator}}</label>
                                                            <select class="form-control" id="sel1" ng-model="newSource.parameters.filter.operators[i].compare_operator" >
                                                                <option>=</option>
                                                                <option>!=</option>
                                                                <option><</option>
                                                                <option>></option>
                                                                <option>IN</option>
                                                                <option>LIKE</option>
                                                                <option>NOT NULL</option>
                                                            </select>
                                                        </div>
                                                        <div class="element-margin form-group-xxs col-xs-5">
                                                            <label class="control-label">{{::ctrl.text.Element.Component.Select.Value}}</label>
                                                            <input type="text" class="form-control" placeholder=""
                                                                   ng-model="newSource.parameters.filter.operators[i].value" >
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--Fenêtre de test-->
                                <div class="col-xs-12" id="Layout_Preview">
                                    <!--Text-->
                                    <div ng-show="newSource.dataType === 'text'">
                                        <div><label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Result}}"></label></div>
                                        <div class="row">
                                            <div class="form-group-xxs col-xs-6">
                                                <select class="element-margin form-control"
                                                        ng-model="newSource.test_result"
                                                        ng-options="option.label for option in newSource.result_options track by option.value">
                                                </select>
                                            </div>
                                            <div class="col-xs-3">
                                                {{newSource.test_result.value}}
                                            </div>
                                            <div class="col-xs-3">
                                                <button ng-if="newSource.dataType === 'tableValue' || newSource.dataType === 'webService' || newSource.dataType === 'businessObject' || newSource.dataType === 'externalDatabase' || newSource.dataType === 'text'" 
                                                        type="submit" 
                                                        class="btn btn-primary right">{{::ctrl.text.Element.Component.Select.Save}}</button>
                                            </div> 
                                        </div>
                                    </div>
                                    <!--Valeurs d'une table-->
                                    <div ng-show="newSource.dataType === 'tableValue' || newSource.dataType === 'webService' || newSource.dataType === 'businessObject' || newSource.dataType === 'externalDatabase'">
                                        <!--Test-->
                                        <div>
                                            <button type="button" class="btn btn-success element-margin" ng-click="ctrl.testDatasource(newSource, 'studio-datasource-add-modal')">Test</button>
                                            <button ng-if="newSource.dataType === 'tableValue' || newSource.dataType === 'webService' || newSource.dataType === 'businessObject' || newSource.dataType === 'externalDatabase' || newSource.dataType === 'text'" 
                                                    type="submit" 
                                                    class="btn btn-primary right">{{::ctrl.text.Element.Component.Select.Save}}</button>
                                        </div>
                                        <div><label class="control-label" data-translate="{{::ctrl.text.Element.Component.Select.Result}}"></label></div>
                                        <div>
                                            <div id="grid-studio-webService-test" ui-grid="studioAddModalTestGridOptions" style="width:856px;height: 350px;" class="grid element-margin"></div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--Modale gestion des onglets-->
        <div id="studio-tabsmanager-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-l">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Loader.ManageTabs}}</h4>
                    </div>
                    <div class="modal-body modal-body-big-with-footer">
                        <div class="row height-100">
                            <div class="col-xs-7 height-100" style="overflow-x: auto">
                                <!--Sélection des attributs dans les onglets-->
                                <table style="width:100%">
                                    <tr>
                                        <th class=""></th>
                                        <th ng-repeat="tab in tabs.list">

                                            <div class="input-group input-group-xs margin-right-20" ng-show="tab.studio_mode === 'edit'">
                                                <input type="text" class="form-control" ng-model="tab.label">
                                                <span class="input-group-addon btn btn-primary btn-xs glyphicon glyphicon-ok" 
                                                      style="min-width: inherit;"
                                                      ng-click="tab.studio_mode = 'display'"></span>
                                            </div>

                                            <div ng-show="tab.studio_mode !== 'edit'">
                                                <div class="dropdown">
                                                    <div class="dropdown-toggle pointer" id="sudio-tabsmanager-modal-table-{{$index}}-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                                        {{tab.label}}
                                                        <span class="caret"></span>
                                                    </div>
                                                    <ul class="dropdown-menu" aria-labelledby="sudio-tabsmanager-modal-table-{{$index}}-dropdown">
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.EditTab}}" href="javascript:void(0);" ng-click="tab.studio_mode = 'edit'">
                                                                <span class="glyphicon glyphicon-pencil font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.EditTab}}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.RemoveTab}}" href="javascript:void(0);" ng-click="ctrl.askAndRemoveTab(tab)">
                                                                <span class="glyphicon glyphicon-remove font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.RemoveTab}}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.SelectAllElements}}" href="javascript:void(0);" ng-click="ctrl.selectAllElems(tab)">
                                                                <span class="glyphicon glyphicon-check font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.SelectAllElements}}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.SelectNoElements}}" href="javascript:void(0);" ng-click="tab.elements = []">
                                                                <span class="glyphicon glyphicon-share font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.SelectNoElements}}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.MoveLeft}}" href="javascript:void(0);" ng-click="ctrl.moveTab(tab, 'left')">
                                                                <span class="glyphicon glyphicon-arrow-left font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.MoveLeft}}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a title="{{::ctrl.text.Loader.MoveRight}}" href="javascript:void(0);" ng-click="ctrl.moveTab(tab, 'right')">
                                                                <span class="glyphicon glyphicon-arrow-right font-12" aria-hidden="true"></span>
                                                                {{::ctrl.text.Loader.MoveRight}}
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </th>
                                    </tr>
                                    <tr ng-repeat="(elemIndex, elem) in elems">
                                        <td class="width-20" ng-class="{'bold': buttons.indexOf(elem) !== -1}">{{elem}}</td>
                                        <td style="width:"
                                            ng-repeat="(tabIndex, tab) in tabs.list">
                                            <div class="checkbox margin-0">
                                                <input id="studio-tabsmanager-modal-show-elem-checkbox-{{elemIndex}}-{{tabIndex}}" 
                                                       type="checkbox"
                                                       ng-checked="tab.elements.indexOf(elem) !== -1"
                                                       ng-click="ctrl.toggleElemOnTab(elem, tab)">
                                                <label for="studio-tabsmanager-modal-show-elem-checkbox-{{elemIndex}}-{{tabIndex}}" class="control-label"></label>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-xs-5 height-100" style="overflow-x: auto">
                                <h4 class="modal-title ng-binding" style="margin-bottom: 15px;">Prévisualisation</h4>
                                <!--Prévisualisation-->
                                <div id="studio_test_tabs_form_reader"
                                     app-form-reader 
                                     app-form-definition-name="sTestTabFormDefinitionName" 
                                     app-form-values="oTestTabFormValues" 
                                     app-form-definition="oTestTabFormDefinition"
                                     app-form-events-container="oFormScope"
                                     app-properties="oProperties"
                                     app-token="sToken"></div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.saveTabs(tabs)">{{::ctrl.text.Loader.Validate}}</button>
                        <button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.addTab()">{{::ctrl.text.Loader.AddTab}}</button>
                        <button type="button" class="btn btn-default right margin-left-20" onclick="$('#studio-tabsmanager-modal').modal('hide');">{{::ctrl.text.Loader.Cancel}}</button>
                    </div>
                </div>
            </div>  
        </div>
        <!--Modale gestion état wab-->
        <div id="studio-wabmanager-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-l">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Loader.ManageWab}}</h4>
                    </div>
                    <div class="modal-body modal-body-big-with-footer" style="padding-bottom: 0px;">
                        <div class="row" style="height:50px">
                            <div class="col-xs-3">
                                <label>{{::ctrl.text.Loader.WabGroup}}</label>
                                <select ng-model="wabSelectedGroup" class="form-control input-xs">
                                    <option ng-repeat="group in wabGroups" value="{{group}}">{{group}}</option>
                                </select>
                            </div>
                            <div class="transition-form-wab-collapser" ng-class="{'col-xs-2' : !wabVisualizer, 'col-xs-7' : wabVisualizer}"></div>
                            <div class="col-xs-2" style="text-align: right;">  
                                <span class=" collapser-form-wab-modal" ng-click="wabVisualizer = !wabVisualizer" ng-class="{'icon-keyboard_arrow_right' : !wabVisualizer, 'icon-keyboard_arrow_left' : wabVisualizer}"></span>                            
                            </div>
                            <div ng-show="!wabVisualizer" class="transition-form-wab-collapser margin-left-15" ng-class="{'col-xs-3' : !wabVisualizer}">
                                <label>{{::ctrl.text.Loader.WabState}}</label>
                                <select ng-model="wabSelectedState" class="form-control input-xs">
                                    <option ng-repeat="(stateName, oState) in wab" value="{{stateName}}">{{stateName}}</option>
                                </select>
                            </div>
                        </div>
                        <br>
                        <div class="row" 
                             style="height: calc(100% - 70px);"
                             ng-if="wabSelectedGroup !== ''">
                            <div class="height-100 table-responsive studio-table-fixed transition-form-wab-collapser" ng-class="{'col-xs-7' : !wabVisualizer, 'col-xs-12' : wabVisualizer}">
                                <!--Sélection des attributs dans les onglets-->
                                <table class="">
                                    <thead>
                                        <tr>
                                            <th class=""></th>
                                            <th ng-repeat="(stateName, oState) in wab|sortStates:wabStates track by $index" style="text-align: center;">
                                                {{oState.name}}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="(elemIndex, elem) in elems" ng-style="{'background-color': ($index % 2 === 1)?'#E6E6E6':'#FFFFFF'}">
                                            <td class="width-20 fixed-first-column" ng-class="{'bold': buttons.indexOf(elem) !== -1}">{{elem}}</td>
                                            <td style="/*padding-left: 40px;*//* min-width: 120px*/"
                                                ng-repeat="(stateName, oState) in wab|sortStates:wabStates track by $index">
                                                <span class="checkbox margin-0 left checkbox-info"
                                                      title="{{::ctrl.text.Loader.AllowDisplayElement}}">
                                                    <input id="studio-wabmanager-modal-display-elem-checkbox-{{elemIndex}}-{{oState.name}}" 
                                                           type="checkbox"
                                                           ng-checked="oState[wabSelectedGroup][elem] === 'r' || oState[wabSelectedGroup][elem] === 'rw'"
                                                           ng-click="ctrl.toggleElemOnWab(elem, oState, wabSelectedGroup, 'r')">
                                                    <label for="studio-wabmanager-modal-display-elem-checkbox-{{elemIndex}}-{{oState.name}}" class="control-label"></label>
                                                </span>
                                                <span class="checkbox margin-0 left checkbox-primary"
                                                      title="{{::ctrl.text.Loader.AllowEditElement}}">
                                                    <input id="studio-wabmanager-modal-edit-elem-checkbox-{{elemIndex}}-{{oState.name}}" 
                                                           type="checkbox"
                                                           ng-checked="oState[wabSelectedGroup][elem] === 'rw'"
                                                           ng-click="ctrl.toggleElemOnWab(elem, oState, wabSelectedGroup, 'rw')">
                                                    <label for="studio-wabmanager-modal-edit-elem-checkbox-{{elemIndex}}-{{oState.name}}" class="control-label"></label>
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div ng-show="!wabVisualizer" class="height-100 transition-form-wab-collapser" style="overflow-x: auto" ng-class="{'col-xs-5' : !wabVisualizer}">
                                <!--Prévisualisation-->
                                <div id="studio_test_wab_form_reader"
                                     app-form-reader 
                                     app-form-definition-name="sTestWabFormDefinitionName" 
                                     app-form-values="oTestWabFormValues" 
                                     app-form-definition="oTestWabFormDefinition"
                                     app-form-events-container="oTestWabFormScope"
                                     app-properties="oProperties"
                                     app-token="sToken"
                                     app-dont-use-wab-parameter="true"></div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.saveWab(wab)">{{::ctrl.text.Loader.Validate}}</button>
                        <!--<button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.addTab()">{{::ctrl.text.Loader.AddTab}}</button>-->
                        <button type="button" class="btn btn-default right margin-left-20" onclick="$('#studio-wabmanager-modal').modal('hide');">{{::ctrl.text.Loader.Cancel}}</button>
                    </div>
                </div>
            </div>  
        </div>
        <!--Modale gestion méthode wab-->
        <div id="studio-wabmanager-method-modal" class="modal fade" role="dialog">
            <div class="modal-dialog" style="width:1200px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">{{::ctrl.text.Loader.ManageWabMethod}}</h4>
                    </div>
                    <div class="modal-body modal-body-big-with-footer" style="padding-bottom: 0px;">
                        <div ng-repeat="oMethod in aBoMethods" class="row" style="margin-left: 5px;">
                           <span class="checkbox margin-0 left checkbox-primary col-xs-5"
                                    title="{{::ctrl.text.Loader.AllowEditElement}}">
                                <input id="studio-wabmanager-modal-edit-method-checkbox-{{$index}}-{{oMethod.name}}" 
                                    type="checkbox"
                                    ng-model="oMethod['selected']">
                                <label for="studio-wabmanager-modal-edit-method-checkbox-{{$index}}-{{oMethod.name}}" class="control-label">{{oMethod.name}} ({{oMethod.tostate_name}})</label>
                            </span>
                            <div class="input-group element-margin input-group-xs col-xs-3" style="float: left;">
                                <span  class="input-group-addon ng-binding ng-scope" id="SuggestModal_group_label">Groupe</span>
                                <input ng-model="oMethod['group']" id="SuggestModal_group_input" type="text" class="form-control ng-pristine ng-untouched ng-valid ng-valid-required" placeholder="Groupe du bouton" aria-describedby="SuggestModal_group_label" required="">
                            </div>
                            <div class="input-group element-margin input-group-xs col-xs-3" style="float: left;margin-left:6%;">
                                <span  class="input-group-addon ng-binding ng-scope" id="SuggestModal_label_label">Label</span>
                                <input ng-model="oMethod['label']" id="SuggestModal_label_input" type="text" class="form-control ng-pristine ng-untouched ng-valid ng-valid-required" placeholder="Label du bouton" aria-describedby="SuggestModal_label_label" required="">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.generateWabMethod()">{{::ctrl.text.Loader.Validate}}</button>
                        <!--<button type="button" class="btn btn-primary right margin-left-20" ng-click="ctrl.addTab()">{{::ctrl.text.Loader.AddTab}}</button>-->
                        <button type="button" class="btn btn-default right margin-left-20" onclick="$('#studio-wabmanager-method-modal').modal('hide');">{{::ctrl.text.Loader.Cancel}}</button>
                    </div>
                </div>
            </div>  
        </div>
    </div>
</div>
