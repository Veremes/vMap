<div class="module-title list-group-item active lighen">MODULE CADASTRE</div>


<div id="cadastre-tools" style="margin-bottom: 10px">

    <!--Onglets de navigation-->
    <ul class="nav nav-tabs white">
        <li style="width: 50%" class="active">
            <a data-toggle="tab" href="#cadastre-by-map-form" onclick="oVmap.getMap().removeActionsAndTooltips()">
                <span class="glyphicon glyphicon-map-marker"></span> Carte
            </a>
        </li>
        <li style="width: 50%">
            <a data-toggle="tab" href="#cadastre-form" onclick="oVmap.getMap().removeActionsAndTooltips()">
                <span class="glyphicon glyphicon-search"></span> Formulaire
            </a>
        </li>
    </ul>

    <!-- Sélection par carte -->
    <div id="cadastre-by-map-form" class="cadastre cadastre-map-search fade absolute active in">

        <div id="cadastre-map-search-accordion" class="panel-group margin-10">

            <!--Rapport en un clic-->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a class="accordion-toggle font-14" 
                           data-toggle="collapse" 
                           data-parent="#cadastre-map-search-accordion" 
                           href="#cadastre-map-search-collapse-one-click"
                           aria-expanded="true" 
                           aria-controls="collapseOne"
                           onclick="oVmap.getMap().removeActionsAndTooltips()">
                            <span class="glyphicon glyphicon-screenshot" style="margin-right: 5px"></span> Rapport en un clic
                            <i class="indicator glyphicon glyphicon-chevron-down pull-right"></i>
                        </a>
                    </h4>
                </div>
                <div id="cadastre-map-search-collapse-one-click" class="panel-collapse collapse in">
                    <div class="panel-body">
                        <i>Choisissez le type de rapport et cliquez sue une parcelle pour voir le rapport</i>
                        <div class="row" style="padding: 10px 5px 0px 5px;">
                            <div class="col-md-4 padding-sides-2 height-md-4" style="height: 85px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-FicheDescriptive'}" ng-click="ctrl.selectCadastreOnMap('FicheDescriptive', ctrl.currentAction === 'cadastre-FicheDescriptive')">
                                    <div class="squared-btn-text">Fiche descriptive</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 height-md-4" style="height: 85px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-ReleveDePropriete'}" ng-click="ctrl.selectCadastreOnMap('ReleveDePropriete', ctrl.currentAction === 'cadastre-ReleveDePropriete')">
                                    <div class="squared-btn-text">Relevé de propriété</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 height-md-4" style="height: 85px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-FicheUrbanisme'}" ng-click="ctrl.selectCadastreOnMap('FicheUrbanisme', ctrl.currentAction === 'cadastre-FicheUrbanisme')">
                                    <div class="squared-btn-text">Fiche d'urbanisme</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!--Recheche avancée-->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a class="accordion-toggle collapsed font-14" 
                           data-toggle="collapse" 
                           data-parent="#cadastre-map-search-accordion" 
                           href="#cadastre-map-search-collapse-advanced-search"
                           onclick="oVmap.getMap().removeActionsAndTooltips()">
                            <span class="glyphicon glyphicon-cog" style="margin-right: 5px"></span> Recherche avancée
                            <i class="indicator glyphicon glyphicon-chevron-down pull-right"></i>
                        </a>
                    </h4>
                </div>
                <div id="cadastre-map-search-collapse-advanced-search" class="panel-collapse collapse">

                    <div class="panel-body">
                        <label>Recherche d'objet</label>
                        <div class="row" style="padding: 0px 5px 0px 5px;">
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.searchOnMapCurrentMode === 'commune'}" ng-click="ctrl.searchOnMapInit('commune')">
                                    <div class="squared-btn-text">Commune</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.searchOnMapCurrentMode === 'section'}" ng-click="ctrl.searchOnMapInit('section')">
                                    <div class="squared-btn-text">Section</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.searchOnMapCurrentMode === 'lieuDit'}" ng-click="ctrl.searchOnMapInit('lieuDit')">
                                    <div class="squared-btn-text">Lieu-dit</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.searchOnMapCurrentMode === 'parcelle'}" ng-click="ctrl.searchOnMapInit('parcelle')">
                                    <div class="squared-btn-text">Parcelle</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.searchOnMapCurrentMode === 'bati'}" ng-click="ctrl.searchOnMapInit('bati')">
                                    <div class="squared-btn-text">Bâti</div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <label>Mode de sélection</label>
                        <div class="row" style="padding: 0px 5px 0px 5px;">
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-selectByPoint'}" ng-click="ctrl.locateCadastreOnMap('Point', ctrl.currentAction === 'cadastre-selectByPoint')">
                                    <div class="squared-btn-text">Point</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-selectByLineString'}" ng-click="ctrl.locateCadastreOnMap('LineString', ctrl.currentAction === 'cadastre-selectByLineString')">
                                    <div class="squared-btn-text">Ligne</div>
                                </div>
                            </div>
                            <div class="col-md-4 padding-sides-2 padding-2 height-md-4" style="height: 89px">
                                <div class="squared-btn" ng-class="{'active': ctrl.currentAction === 'cadastre-selectByPolygon'}" ng-click="ctrl.locateCadastreOnMap('Polygon', ctrl.currentAction === 'cadastre-selectByPolygon')">
                                    <div class="squared-btn-text">Polygone</div>
                                </div>
                            </div>
                        </div>
                        <div class="checkbox checkbox-info left margin-2 margin-sides-10">
                            <input id="cadastre-location-multiple-checkbox" type="checkbox" ng-model="ctrl.locationMultiple" class="ng-pristine ng-untouched ng-valid">
                            <label for="cadastre-location-multiple-checkbox">
                                Ajouter à la sélection
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!--Boutons-->
        <div class="cadastre-btn-container" style="margin-left: -4px;">
            <div class="cadastre-btn-container-title">UTILISER LA SELECTION</div>
            <div class="cadastre-btn-container-actions">
                <div class="cadastre-btn-container-actions-element-3" ng-click="ctrl.selectLocation()">
                    <span class="glyphicon glyphicon-plus cadastre-btn-container-actions-element-icon"></span>
                    <div class="margin-sides-10">Ajouter au panier</div>

                </div>
                <div id="cadastre-btn-container-actions-map-replace-card" class="cadastre-btn-container-actions-element-3" ng-click="ctrl.emptySelection();
                    ctrl.selectLocation()">
                    <span class="glyphicon glyphicon-repeat cadastre-btn-container-actions-element-icon"></span>
                    <div class="margin-sides-10">Remplacer panier</div>
                </div>
                <div class="cadastre-btn-container-actions-element-3" onclick="oVmap.getMap().getLocationOverlayFeatures().clear()">
                    <span class="glyphicon glyphicon-remove cadastre-btn-container-actions-element-icon"></span>
                    <div class="margin-sides-10">Effacer la sélection</div>
                </div>
            </div>
            <div class="cadastre-btn-container-rapports">
                <button class="btn" type="button" ng-click="ctrl.initRapportsBootstrapTables('#Cadastre-rapports')">
                    <span class="left glyphicon glyphicon-new-window" style="margin: 4px 8px"></span>
                    <span class="left" style="margin: 0px 14px">Générer un rapport</span>
                    <span class="right" style="margin: 6px 0px">
                        <span class="icon-keyboard_arrow_right list-group-icon2"></span>
                    </span>
                </button>
            </div>
        </div>

    </div>

    <!--Formulaires-->
    <div id="cadastre-form" class="forms-container fade absolute">

        <!--Menu-->
        <div class="margin-sides-3" style="margin-top: 5px">
            <label class="font-11">Recherche d'objet:</label>
            <div class="btn-group" style="width: 100%">
                <a class="btn btn-sm font-11 btn-dropdown dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false">
                    <div id="cadastre-parcelle-form-menu" class="left"></div> <span class="caret right" style="margin: 5px;;"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-auto font-12">
                    <li class="inactive">
                        <a data-toggle="pill" ng-click="ctrl.currentMode = 'commune'" href="#cadastre-Commune-form">Commune</a>
                    </li>
                    <li class="inactive">
                        <a data-toggle="pill" ng-click="ctrl.currentMode = 'section'" href="#cadastre-Section-form">Section</a>
                    </li>
                    <li class="inactive">
                        <a data-toggle="pill" ng-click="ctrl.currentMode = 'lieuDit'" href="#cadastre-Lieu-dit-form">Lieu dit</a>
                    </li>
                    <li class="inactive">
                        <a data-toggle="pill" ng-click="ctrl.currentMode = 'parcelle'" href="#cadastre-Parcelle-form">Parcelle</a>
                    </li>
                    <li class="inactive">
                        <a data-toggle="pill" ng-click="ctrl.currentMode = 'bati'" href="#cadastre-Bati-par-proprietaire-form">Bâti</a>
                    </li>
                </ul>
            </div>
        </div>

        <!--Formulaires-->
        <div class="cadastre-forms">
            <!-- Commune -->
            <div id="cadastre-Commune-form" class="cadastre fade absolute">

                <label class="cadastre-label">Commune</label>
                <select id="Commune-select-commune" class="form-control minus" style="width: inherit">
                    <option value=""></option>
                    <option ng-repeat="commune in ctrl.aCommunes" ng-if="commune.nom !== ''" value="{{commune.id_com}}">{{commune.nom}}</option>
                </select>
                <br>
            </div>

            <!-- Section -->
            <div id="cadastre-Section-form" class="cadastre fade absolute">

                <label class="cadastre-label">Commune</label>
                <select id="Section-select-commune" class="form-control minus" style="width: inherit" ng-model="sectionCommune" ng-change="ctrl.putBaseElemBySelectOnTable(ctrl.cadastreAPI_ + '/sections', 'id_com', '#Section-select-commune', '#Section-table-section', 'section')">
                    <option value=""></option>
                    <option ng-repeat="sectionCommune in ctrl.aCommunes" ng-if="sectionCommune.nom !== ''" value="{{sectionCommune.id_com}}">{{sectionCommune.nom}}</option>
                </select>

                <label class="cadastre-label">Section(s)</label>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <div id="Section-table-section-toolbar" class="btn-group cadastre-table-btn-group" style="display: none">
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Section-table-section')" title="Sélectionner tout">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Section-table-section')" title="Déselectionner tout">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
                <table id="Section-table-section" data-toolbar="#Section-table-section-toolbar" data-toggle="table" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="commune"></th>
                            <th data-field="section"></th>
                        </tr>
                    </thead>
                </table>
            </div>

            <!-- Lieu dit -->
            <div id="cadastre-Lieu-dit-form" class="cadastre fade absolute">

                <label class="cadastre-label">Commune</label>
                <select id="Lieu-dit-select-commune" class="form-control minus" style="width: inherit" ng-model="lieuDitCommune" ng-change="ctrl.putBaseElemBySelectOnTable(ctrl.cadastreAPI_ + '/lieudits', 'id_com', '#Lieu-dit-select-commune', '#Lieu-dit-table-lieu-dit', 'tex')">
                    <option value=""></option>
                    <option ng-repeat="lieuDitCommune in ctrl.aCommunes" ng-if="lieuDitCommune.nom !== ''" value="{{lieuDitCommune.id_com}}">{{lieuDitCommune.nom}}</option>
                </select>

                <label class="cadastre-label">Lieu dit</label>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <div id="Lieu-dit-table-lieu-dit-toolbar" class="btn-group" style="display: none">
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Lieu-dit-table-lieu-dit')" title="Sélectionner tout">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Lieu-dit-table-lieu-dit')" title="Déselectionner tout">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
                <table id="Lieu-dit-table-lieu-dit" data-toolbar="#Lieu-dit-table-lieu-dit-toolbar" data-toggle="table" data-search="true" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="tex"></th>
                        </tr>
                    </thead>
                </table>
            </div>

            <!-- Parcelle -->
            <div id="cadastre-Parcelle-form" class="cadastre fade absolute">
                <label class="cadastre-label">Recherche par:</label>
                <div class="btn-group" style="width: 100%">
                    <a class="btn btn-sm font-11 btn-dropdown dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false">
                        <div id="cadastre-parcelle-form-menu" class="left"></div> <span class="caret right" style="margin: 5px;"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-auto font-12">
                        <li class="inactive">
                            <a data-toggle="pill" ng-click="ctrl.currentParcelleMode = 'section'" href="#cadastre-Parcelle-par-section-form">Section</a>
                        </li>
                        <li class="inactive">
                            <a data-toggle="pill" ng-click="ctrl.currentParcelleMode = 'adresse'" href="#cadastre-Parcelle-par-adresse-DGFiP-form">Adresse DGFiP</a>
                        </li>
                        <li class="inactive">
                            <a data-toggle="pill" ng-click="ctrl.currentParcelleMode = 'proprietaire'" href="#cadastre-Parcelle-par-proprietaire-form">Propriétaire</a>
                        </li>
                    </ul>
                </div>

                <!-- Parcelle par section -->
                <div id="cadastre-Parcelle-par-section-form" class="cadastre parcelle fade absolute">
                    <label class="cadastre-label">Commune</label>
                    <select id="Parcelle-select-commune" class="form-control minus" style="width: inherit" ng-model="parcelleCommune" onchange="$('#Parcelle-table-parcelle').bootstrapTable('load', []);" ng-change="ctrl.getBaseElemBySelect(ctrl.cadastreAPI_ + '/sections', 'id_com', '#Parcelle-select-commune', 'aSections', 'section')">
                        <option value=""></option>
                        <option ng-repeat="parcelleCommune in ctrl.aCommunes" ng-if="parcelleCommune.nom !== ''" value="{{parcelleCommune.id_com}}">{{parcelleCommune.nom}}</option>
                    </select>

                    <label class="cadastre-label">Section</label>
                    <select id="Parcelle-select-section" class="form-control minus" style="width: inherit" ng-model="parcelleSection" ng-change="ctrl.putBaseElemBy2SelectOnTable(ctrl.cadastreAPI_ + '/parcelles', 'id_com', '#Parcelle-select-commune', 'id_sec', '#Parcelle-select-section', '#Parcelle-table-parcelle', 'parcelle')">
                        <option value=""></option>
                        <option ng-repeat="parcelleSection in ctrl.aSections" value="{{parcelleSection.id_sec}}">{{parcelleSection.section}}</option>
                    </select>

                    <label class="cadastre-label">Parcelle(s)</label>
                    <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                    <div id="Parcelle-table-parcelle-toolbar" class="btn-group">
                        <button type="button" id="Parcelle-table-parcelle-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Parcelle-table-parcelle')" title="Sélectionner tout">
                            <span class="glyphicon glyphicon-ok"></span>
                        </button>
                        <button type="button" id="Parcelle-table-parcelle-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Parcelle-table-parcelle')" title="Déselectionner tout">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </div>
                    <table id="Parcelle-table-parcelle" data-toolbar="#Parcelle-table-parcelle-toolbar" data-toggle="table" data-search="true" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                        <thead>
                            <tr>
                                <th data-field="state" data-checkbox="true"></th>
                                <th data-field="id_par"></th>
                            </tr>
                        </thead>
                    </table>
                </div>

                <!-- Parcelle par adresse DGFiP -->
                <div id="cadastre-Parcelle-par-adresse-DGFiP-form" class="cadastre parcelle fade absolute">

                    <label class="cadastre-label">Commune</label>
                    <select id="Parcelle-par-adresse-DGFiP-select-commune" class="form-control minus" style="width: inherit" ng-model="parcelleparadresseDGFiPCommune" ng-change="ctrl.getBaseVoiesOnTable(ctrl.cadastreAPI_ + '/voies', 'ID_COM', '#Parcelle-par-adresse-DGFiP-select-commune', '#Parcelle-par-adresse-DGFiP-table-voie')">
                        <option value=""></option>
                        <option ng-repeat="parcelleparadresseDGFiPCommune in ctrl.aCommunes" ng-if="parcelleparadresseDGFiPCommune.nom !== ''" value="{{parcelleparadresseDGFiPCommune.id_com}}">{{parcelleparadresseDGFiPCommune.nom}}</option>
                    </select>

                    <label class="cadastre-label">Voie</label>
                    <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                    <table id="Parcelle-par-adresse-DGFiP-table-voie" data-toggle="table" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                        <thead>
                            <tr>
                                <th data-field="state" data-radio="true"></th>
                                <th data-field="DVOILIB"></th>
                                <th data-field="ID_RIVOLI" data-visible="false"></th>
                            </tr>
                        </thead>
                    </table>

                    <label class="cadastre-label">Adresse(s)</label>
                    <select id="Parcelle-par-adresse-DGFiP-select-adresse" class="form-control minus" style="width: inherit">
                        <option value="">Toutes</option>
                        <option ng-repeat="parcelleparadresseDGFiPVoie in ctrl.aAdresses" ng-if="parcelleparadresseDGFiPVoie.DNVOIRI.trim().length !== 0" value="{{parcelleparadresseDGFiPVoie.ID_PAR}}">{{parcelleparadresseDGFiPVoie.DNVOIRI}}</option>
                    </select>
                </div>

                <!-- Parcelle par propriétaire -->
                <div id="cadastre-Parcelle-par-proprietaire-form" class="cadastre parcelle fade absolute">

                    <label class="cadastre-label">Commune</label>
                    <select id="Parcelle-par-proprietaire-select-commune" class="form-control minus" style="width: inherit" onchange="	$('#Parcelle-par-proprietaire-table-proprietaire').bootstrapTable('removeAll');
                            $('#Parcelle-par-proprietaire-table-comptes').bootstrapTable('removeAll');
                            $('#Parcelle-par-proprietaire-table-parcelles').bootstrapTable('removeAll');
                            ">
                        <option value=""></option>
                        <option ng-repeat="parcelleparproprietaireCommune in ctrl.aCommunes" ng-if="parcelleparproprietaireCommune.nom !== ''" value="{{parcelleparproprietaireCommune.id_com}}">{{parcelleparproprietaireCommune.nom}}</option>
                    </select>

                    <label class="cadastre-label">Propriétaire</label>
                    <form class="input-group" ng-submit="ctrl.getParcelleBaseProprietairesOnTable('#Parcelle-par-proprietaire-select-commune', '#Parcelle-par-proprietaire-search-proprietaire', '#Parcelle-par-proprietaire-table-proprietaire', '#Parcelle-par-proprietaire-table-comptes', '#Parcelle-par-proprietaire-table-parcelles')" style="width: 100%">
                        <input id="Parcelle-par-proprietaire-search-proprietaire" class="form-control minus" type="text" placeholder="Propriétaire" style="width: 73%">
                        <button type="submit" class="btn btn-success btn-sm font-11" style="width: 27%;padding: 3px 10px;">Chercher</button>
                    </form>
                    <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                    <table id="Parcelle-par-proprietaire-table-proprietaire" 
                           data-toggle="table" 
                           data-height="120" 
                           data-sort-name="ddenom"
                           data-show-header="false" 
                           data-click-to-select="true" 
                           class="font-10 pointer cadastre-table-list transparent">
                        <thead>
                            <tr>
                                <th data-field="state" data-radio="true"></th>
                                <th data-field="ID_COM" data-visible="false"></th>
                                <th data-field="DDENOM"></th>
                            </tr>
                        </thead>
                    </table>
                    <label class="cadastre-label">Compte(s)</label>
                    <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                    <div id="Parcelle-par-proprietaire-table-comptes-toolbar" class="btn-group" style="display: none">
                        <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Parcelle-par-proprietaire-table-comptes')" title="Sélectionner tout">
                            <span class="glyphicon glyphicon-ok"></span>
                        </button>
                        <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Parcelle-par-proprietaire-table-comptes')" title="Déselectionner tout">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </div>
                    <table id="Parcelle-par-proprietaire-table-comptes" data-toggle="table" data-height="150" data-toolbar="#Parcelle-par-proprietaire-table-comptes-toolbar" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                        <thead>
                            <tr>
                                <th data-field="state" data-checkbox="true"></th>
                                <th data-field="ID_COM" data-visible="false"></th>
                                <th data-field="DNUPRO"></th>
                            </tr>
                        </thead>
                    </table>

                    <label class="cadastre-label">Parcelles(s)</label>
                    <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                    <div id="Parcelle-par-proprietaire-table-parcelles-toolbar" class="btn-group" style="display: none">
                        <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Parcelle-par-proprietaire-table-parcelles')" title="Sélectionner tout">
                            <span class="glyphicon glyphicon-ok"></span>
                        </button>
                        <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Parcelle-par-proprietaire-table-parcelles')" title="Déselectionner tout">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </div>
                    <table id="Parcelle-par-proprietaire-table-parcelles" data-toggle="table" data-height="150" data-toolbar="#Parcelle-par-proprietaire-table-parcelles-toolbar" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                        <thead>
                            <tr>
                                <th data-field="state" data-checkbox="true"></th>
                                <th data-field="ID_PAR" data-visible="true"></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>

            <!-- Bâti par propriétaire -->
            <div id="cadastre-Bati-par-proprietaire-form" class="cadastre fade absolute">
                <label class="cadastre-label">Commune</label>
                <select id="Bati-par-proprietaire-select-commune" class="form-control minus" style="width: inherit" ng-model="batiparproprietaireCommune" onchange="
                        $('#Bati-par-proprietaire-table-proprietaire').bootstrapTable('removeAll');
                        $('#Bati-par-proprietaire-table-comptes').bootstrapTable('removeAll');
                        $('#Bati-par-proprietaire-table-invariants').bootstrapTable('removeAll');
                        $('#Bati-par-proprietaire-table-parcelles').bootstrapTable('removeAll');
                        ">
                    <option value=""></option>
                    <option ng-repeat="batiparproprietaireCommune in ctrl.aCommunes" ng-if="batiparproprietaireCommune.nom !== ''" value="{{batiparproprietaireCommune.id_com}}">{{batiparproprietaireCommune.nom}}</option>
                </select>

                <label class="cadastre-label">Propriétaire</label>
                <form class="input-group" ng-submit="ctrl.getBatiBaseProprietairesOnTable('#Bati-par-proprietaire-select-commune', '#Bati-par-proprietaire-search-proprietaire', '#Bati-par-proprietaire-table-proprietaire', '#Bati-par-proprietaire-table-comptes', '#Bati-par-proprietaire-table-invariants', '#Bati-par-proprietaire-table-parcelles')" style="width: 100%">
                    <input id="Bati-par-proprietaire-search-proprietaire" class="form-control minus" type="text" placeholder="Propriétaire" style="width: 73%">
                    <button type="submit" class="btn btn-success btn-sm font-11" style="width: 27%;padding: 3px 10px;">Chercher</button>
                </form>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <table id="Bati-par-proprietaire-table-proprietaire" 
                       data-toggle="table" 
                       data-height="120" 
                       data-sort-name="ddenom" 
                       data-show-header="false" 
                       data-click-to-select="true" 
                       class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-radio="true"></th>
                            <th data-field="DDENOM"></th>
                        </tr>
                    </thead>
                </table>
                <label class="cadastre-label">Compte(s)</label>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <div id="Bati-par-proprietaire-table-comptes-toolbar" class="btn-group" style="display: none">
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Bati-par-proprietaire-table-comptes')" title="Sélectionner tout">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Bati-par-proprietaire-table-comptes')" title="Déselectionner tout">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
                <table id="Bati-par-proprietaire-table-comptes" data-toggle="table" data-height="120" data-toolbar="#Bati-par-proprietaire-table-comptes-toolbar" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="DNUPRO"></th>
                        </tr>
                    </thead>
                </table>

                <label class="cadastre-label">Invariant(s)</label>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <div id="Bati-par-proprietaire-table-invariants-toolbar" class="btn-group" style="display: none">
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Bati-par-proprietaire-table-invariants')" title="Sélectionner tout">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Bati-par-proprietaire-table-invariants')" title="Déselectionner tout">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
                <table id="Bati-par-proprietaire-table-invariants" data-toggle="table" data-height="120" data-toolbar="#Bati-par-proprietaire-table-invariants-toolbar" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="ID_PAR" data-visible="false"></th>
                            <th data-field="INVAR"></th>
                        </tr>
                    </thead>
                </table>

                <label class="cadastre-label">Parcelles(s)</label>
                <!-- Element bootstrap-table plugin (http://bootstrap-table.wenzhixin.net.cn/examples)  -->
                <div id="Bati-par-proprietaire-table-parcelles-toolbar" class="btn-group" style="display: none">
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableCheckAll('#Bati-par-proprietaire-table-parcelles')" title="Sélectionner tout">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <button type="button" id="Lieu-dit-table-lieu-dit-check-all" class="btn btn-sm font-11 btn-default cadastre-list-select-all" onclick="oVmap.getToolsManager().getTool('Cadastre').tableUncheckAll('#Bati-par-proprietaire-table-parcelles')" title="Déselectionner tout">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
                <table id="Bati-par-proprietaire-table-parcelles" data-toggle="table" data-height="120" data-toolbar="#Bati-par-proprietaire-table-parcelles-toolbar" data-search="true" data-sort-name="voie" data-show-header="false" data-click-to-select="true" class="font-10 pointer cadastre-table-list transparent">
                    <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="id_par"></th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>

        <!--Boutons-->
        <div class="cadastre-btn-container">
            <div class="cadastre-btn-container-title">UTILISER LA SELECTION</div>
            <div class="cadastre-btn-container-actions">
                <div class="cadastre-btn-container-actions-element" ng-click="ctrl.addToCard(ctrl.currentMode);">
                    <span class="glyphicon glyphicon-plus cadastre-btn-container-actions-element-icon"></span> Ajouter au panier
                </div>
                <div class="cadastre-btn-container-actions-element" ng-click="ctrl.emptySelection();
                    ctrl.addToCard(ctrl.currentMode);">
                    <span class="glyphicon glyphicon-repeat cadastre-btn-container-actions-element-icon"></span> Remplacer panier
                </div>
                <div class="cadastre-btn-container-actions-element" onclick="oVmap.getMap().getLocationOverlayFeatures().clear()">
                    <span class="glyphicon glyphicon-remove cadastre-btn-container-actions-element-icon"></span> Effacer la localisation
                </div>
                <div class="cadastre-btn-container-actions-element" ng-click="ctrl.locateSelection(ctrl.currentMode)">
                    <span class="glyphicon glyphicon-map-marker cadastre-btn-container-actions-element-icon"></span> Localiser la sélection
                </div>
            </div>
            <div class="cadastre-btn-container-rapports">
                <button class="btn" type="button" ng-click="ctrl.initRapportsBootstrapTables('#Cadastre-rapports')">
                    <span class="left glyphicon glyphicon-new-window" style="margin: 4px 8px"></span>
                    <span class="left" style="margin: 0px 14px">Générer un rapport</span>
                    <span class="right" style="margin: 6px 0px">
                        <span class="icon-keyboard_arrow_right list-group-icon2"></span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Rapports -->
<div class="modal fade" id="rapports-modal" tabindex="-1" role="dialog" style="z-index: 1042">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title" id="myModalLabel"><span class="glyphicon glyphicon-new-window"></span> Générer un rapport</h3>
            </div>
            <div class="modal-body modal-body-big">
                <div id="Cadastre-rapports" style="height: 100%;">


                    <div class="row" style="height: 100%;">
                        <div class="col-md-3">
                            <br>
                            <ul class="nav nav-pills nav-stacked" style="width: 180px">
                                <li data-toggle="pill" href="#cadastre-rapport-parcelle" class="list-group-item list-group-item-modal active">Parcelle</li>
                                <li data-toggle="pill" href="#cadastre-rapport-compte" class="list-group-item list-group-item-modal">Compte</li>
                            </ul>
                        </div>

                        <div class="col-md-9" style="height: 100%;">

                            <!--Parcelle-->
                            <div id="cadastre-rapport-parcelle" class="mapmodal-element fade active in">
                                <br>
                                <div class="cadastre-rapport-table-container">
                                    <table id="Cadastre-rapports-table-parcelle" 
                                           data-toggle="table" 
                                           data-sort-name="parcelle" 
                                           data-show-header="true" 
                                           data-click-to-select="true" 
                                           class="font-11 pointer cadastre-table-list-with-checkbox transparent">
                                        <thead>
                                            <tr>
                                                <th data-field="state" data-checkbox="true"></th>
                                                <th data-field="id_com" data-visible="false"></th>
                                                <th data-field="id_par" data-visible="false"></th>
                                                <th data-field="commune" data-sortable="true">Commune</th>
                                                <th data-field="section" data-sortable="true">Section</th>
                                                <th data-field="parcelle" data-sortable="true">Parcelle</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayParcelleDescriptiveSheetByTable('#Cadastre-rapports-table-parcelle')">
                                            <span class="glyphicon glyphicon-download-alt"></span> Fiche descriptive
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayUrbanismeSheetByTable('#Cadastre-rapports-table-parcelle')">
                                            <span class="glyphicon glyphicon-download-alt"></span> Fiche d'urbanisme
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayReleveDeProprieteSheetParcelle('#Cadastre-rapports-table-parcelle')">
                                            <span class="glyphicon glyphicon-download-alt"></span> Relevé de propriété standard
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'ToutesInfos', true)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Toutes les informations
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'BatieNonBatie', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Emprises bâties/non-bâties
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'Proprietaire', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Propriétaires
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'SubdivisionFiscale', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Subdivisions fiscales
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'EmprisePosPlu', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Emprises
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'Locaux', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Locaux
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayRapportParcelle('#Cadastre-rapports-table-parcelle', 'ProprietaireLocaux', false)">
                                            <span class="glyphicon glyphicon-download-alt"></span> Propriétaires des locaux
                                        </div>
                                    </div>
                                </div>


                                <a id="cadastre-download-file" class="hidden" href="#" download="rapport.xls">
                                    <span class="glyphicon glyphicon-download-alt"></span> Télécharger le fichier
                                </a>

                            </div>

                            <!--Compte-->
                            <div id="cadastre-rapport-compte" class="mapmodal-element fade">
                                <br>
                                <div class="cadastre-rapport-table-container">
                                    <table id="Cadastre-rapports-table-comptes" data-toggle="table" data-sort-name="parcelle" data-show-header="true" data-click-to-select="true" class="font-11 pointer cadastre-table-list transparent">
                                        <thead>
                                            <tr>
                                                <th data-field="state" data-radio="true"></th>
                                                <th data-field="id_com" data-visible="false"></th>
                                                <th data-field="COMMUNE" data-sortable="true">Commune</th>
                                                <th data-field="DDENOM" data-sortable="true">Propriétaire</th>
                                                <th data-field="DNUPRO" data-sortable="true">DNUPRO</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayReleveDeProprieteSheetStandard('#Cadastre-rapports-table-comptes')" title="Relevé de propriété standard associé au compte">
                                            <span class="glyphicon glyphicon-download-alt"></span> Relevé de propriété standard
                                        </div>
									  
                                    </div>
									<div class="col-md-6">
                                        <div class="cadastre-rapports-fiche-btn" ng-click="ctrl.displayReleveDeProprieteSheetTiers('#Cadastre-rapports-table-comptes')" title="Relevé de propriété tiers associé au compte">
                                            <span class="glyphicon glyphicon-download-alt"></span> Relevé de propriété vers un tiers
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Fiche descriptive de la parcelle -->
<div class="modal fade" id="descriptive-parcelle-sheet-modal" role="dialog">
    <div class="modal-dialog modal-lg">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Fiche descriptive de la parcelle</h4>
            </div>
            <div id="descriptive-parcelle-sheet-content" class="modal-body modal-body-big-with-footer">

                <!-- Parcelle -->
                <h3>{{ctrl.oParcelleInfos.parcelle}}</h3>
                <hr>
                <table class="table font-12 table-no-bordered">
                    <tbody>
                        <tr>
                            <td class="bold padding-3">Commune:</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.commune}}({{ctrl.oParcelleInfos.ID_COM}})</td>
                        </tr>
                        <tr>
                            <td class="bold padding-3">Surface Géographique:</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.sup_fiscale}}</td>
                        </tr>
                        <tr>
                            <td class="bold padding-3">Contenance:</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.DCNTPA}}</td>
                        </tr>
                        <tr>
                            <td class="bold padding-3">Adresse DGFiP:</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.DNVOIRI}} {{ctrl.oParcelleInfos.DINDIC}} {{ctrl.oParcelleInfos.L_NATURE_VOIE}} {{ctrl.oParcelleInfos.DVOILIB}}({{ctrl.oParcelleInfos.CCORIV}})</td>
                        </tr>
                        <tr>
                            <td class="bold padding-3">Batie:</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.GPARBAT}}</td>
                        </tr>
                        <tr>
                            <td class="bold padding-3">Urbaine :</td>
                            <td class="padding-3">{{ctrl.oParcelleInfos.GURBPA}}</td>
                        </tr>
                    </tbody>
                </table>

                <button class="btn btn-primary btn-sm font-11 margin-sides-10 right print-hidden" data-dismiss="modal" ng-click="ctrl.displayUrbanismeSheet(ctrl.oParcelleInfos.ID_PAR)">Fiche d'urbanisme</button>
                <button class="btn btn-primary btn-sm font-11 margin-sides-10 right print-hidden" data-dismiss="modal" onclick="$('#releve-propriete-modal-menu').modal('show')" 
                        ng-click="ctrl.tmpID_PAR = ctrl.oParcelleInfos.ID_PAR; ctrl.tmpID_DNUPRO = ctrl.oParcelleInfos.ID_COM + ctrl.oParcelleInfos.aProprietaires[0].DNUPRO">Relevés de propriété</button>
                <br>

                <!-- Propriétaires -->
                <div ng-if="ctrl.oParcelleInfos.aProprietaires.length !== 0">
                    <h4 ng-if="ctrl.oParcelleInfos.aProprietaires.length === 1">Propriétaire</h4>
                    <h4 ng-if="ctrl.oParcelleInfos.aProprietaires.length !== 1">Propriétaires</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>Nom</th>
                                <th>État civil</th>
                                <th>Adresse</th>
                                <th>Indivision</th>
                                <th>Droit</th>
                                <th>Destinataire de l'avis</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="proprietaire in ctrl.oParcelleInfos.aProprietaires">
                                <td>{{proprietaire.DQUALP}} {{proprietaire.DDENOM}}</td>
                                <td> <div ng-if="proprietaire.DLDNSS!=null && proprietaire.DLDNSS!=''">Né{{proprietaire.accordSexe}} le {{proprietaire.JDATNSS}} à {{proprietaire.DLDNSS}}</div></td>
                                <td>{{proprietaire.DLIGN3}} {{proprietaire.DLIGN4}} {{proprietaire.DLIGN6}}</td>
                                <td>{{proprietaire.L_CCODEM}}</td>
                                <td>{{proprietaire.L_CCODRO}}</td>
                                <td style="text-align: right">{{proprietaire.GDESIP === "1" ? 'Oui' : 'Non'}}</td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                </div>

                <!-- Subdivision Fiscale -->
                <div ng-if="ctrl.oParcelleInfos.aSubdivisionFiscale.length !== 0">
                    <h4 ng-if="ctrl.oParcelleInfos.aSubdivisionFiscale.length === 1">Subdivision Fiscale</h4>
                    <h4 ng-if="ctrl.oParcelleInfos.aSubdivisionFiscale.length !== 1">Subdivision Fiscales</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>Lettre</th>
                                <th>Groupe</th>
                                <th>Nature</th>
                                <th>Occupation</th>
                                <th>Classe</th>
                                <th>Surface</th>
                                <th>Revenu</th>
                                <th>Référence</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="subdivision in ctrl.oParcelleInfos.aSubdivisionFiscale">
                                <td>{{subdivision.CCOSUB}}</td>
                                <td>{{subdivision.DSGRPF}}</td>
                                <td>{{subdivision.CNATSP}}</td>
                                <td>{{subdivision.L_DSGRPF}}</td>
                                <td>{{subdivision.DCLSSF}}</td>
                                <td>{{subdivision.DCNTSF}}</td>
                                <td>{{subdivision.DRCSUBA}}</td>
                                <td>{{subdivision.DRCSUB}}</td>
                            </tr>
                            <tr class="font-14 bold">
                                <td>Total</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>{{ctrl.oParcelleInfos.aSubdivisionFiscale.totalDcntsf}}</td>
                                <td>{{ctrl.oParcelleInfos.aSubdivisionFiscale.totalDrcsuba}}</td>
                                <td>{{ctrl.oParcelleInfos.aSubdivisionFiscale.totalDrcsub}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Elément Bâti -->
                <div ng-if="ctrl.oParcelleInfos.aBatis.length !== 0">
                    <h4 ng-if="ctrl.oParcelleInfos.aBatis.length === 1">Elément Bâti</h4>
                    <h4 ng-if="ctrl.oParcelleInfos.aBatis.length !== 1">Eléments Bâti</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th></th>
                                <th>Invariant</th>
                                <th>Type</th>
                                <th>Nature</th>
                                <th>Occupation</th>
                                <th>Date mut.</th>
                                <th>Année c.</th>
                                <th>Propriétaire dest.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oParcelleInfos.aBatis">
                                <td>
                                    <button class="btn btn-primary left" ng-click="ctrl.displayInvariantDescriptiveSheet(element.ID_BAT)">
                                        <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                                    </button>
                                </td>
                                <td>{{element.INVAR}}</td>
                                <td>{{element.L_DTELOC}}</td>
                                <td>{{element.L_CCONLC}}</td>
                                <td>{{element.L_DNATLC}}</td>
                                <td>{{element.JDATAT.substr(0, 2)}}/{{element.JDATAT.substr(2, 2)}}/{{element.JDATAT.substr(4, 4)}}</td>
                                <td>{{element.JANNAT}}</td>
                                <td>{{element.DDENOM}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Custom elements (rajoutés dans les properties dans l'API) -->
                <div ng-repeat="node in ctrl.oParcelleInfos.aIntersections">
                    <div ng-if="node.data.length > 0">
                        <h4>{{node.title}}</h4>
                        <table class="table font-12">
                            <thead>
                                <!-- Noms des champs -->
                                <tr class="blue color-white">
                                    <th ng-repeat="(value, key) in node.data[0]">{{node[value]}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Valeurs des champs -->
                                <tr ng-repeat="row in node.data">
                                    <td ng-repeat="(value, key) in row">{{key}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- /.modal-body -->
            </div>
            <div class="modal-footer" ng-if="ctrl.sketchesLenght !== 0">
                <button class="btn btn-primary left" onclick="oVmap.printElem('#descriptive-parcelle-sheet-content')">
                    <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Fiche descriptive de l'invariant-->
<div class="modal fade" id="descriptive-invariant-sheet-modal" role="dialog">
    <div class="modal-dialog modal-lg">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Fiche descriptive d'un invariant</h4>
            </div>
            <div id="descriptive-invariant-sheet-content" class="modal-body modal-body-big-with-footer">

                <!-- Parcelle -->
                <h3>Invariant: {{ctrl.oInvariant.INVAR}}</h3>
                <hr>
                <table class="table font-12 table-no-bordered">
                    <tbody>
                        <tr>
                            <td class="padding-0 bold">Adresse: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.DVOILIB}} </td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Bat.: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.DNUBAT}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Esc.: </td>
                            <td class="padding-0"> {{parseFloat(ctrl.oInvariant.DESC)}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Niv.: </td>
                            <td class="padding-0"> {{parseFloat(ctrl.oInvariant.DNIV)}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Commune: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.LIBCOM}}({{ctrl.oInvariant.ID_COM}})</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Type: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.L_DTELOC}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Nature: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.L_CCONLC}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Occupation: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.L_DNATLC}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Date de mutation: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.JDATAT}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Mutation propriétaire: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.CCHPR = "*" ? 'Oui' : 'Non'}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Année de construction: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.JANNAT}}</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Valeur locative totale: </td>
                            <td class="padding-0"> {{ctrl.oInvariant.DVLTRT}} €</td>
                        </tr>
                        <tr>
                            <td class="padding-0 bold">Nombre d'étages: </td>
                            <td class="padding-0"> {{parseFloat(ctrl.oInvariant.DNBNIV)}}</td>
                        </tr>
                    </tbody>
                </table>
                <br>

                <!-- P.E.V -->
                <div ng-if="ctrl.oInvariant.PEV.length !== 0">
                    <h4>P.E.V</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>Numéro</th>
                                <th>Nature</th>
                                <th>Catégorie</th>
                                <th>Tarif</th>
                                <th>Type de local</th>
                                <th>Valeur cad.</th>
                                <th>Valeur imp.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.PEV">
                                <td>{{parseFloat(element.DNUPEV)}}</td>
                                <td>{{element.L_CCOAFF}}</td>
                                <td>{{element.DCAPEC}}</td>
                                <td>{{element.CCOSTB}}</td>
                                <td>{{element.DNUREF}}</td>
                                <td>{{element.BIPEVLA1}}€</td>
                                <td>{{element.VLBAIA1}}€</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Habitations -->
                <div ng-if="ctrl.oInvariant.habitations.length !== 0">
                    <h4>Habitation principale</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>P.E.V</th>
                                <th>Elements de confort</th>
                                <th>Divers</th>
                                <th>Pièces(s)</th>
                                <th>Annexe(s)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.habitations">
                                <!-- P.E.V -->
                                <td>{{parseFloat(element.DNUPEV)}}</td>
                                <!-- Elements de confort -->
                                <td>
                                    <span>Eau:</span> <span ng-if="element.GEAULC === 'O'">Oui</span> <span ng-if="element.GEAULC === 'N'">Oui</span>
                                    <br>
                                    <span>Electricité:</span> <span ng-if="element.GELELC === 'O'">Oui</span> <span ng-if="element.GELELC === 'N'">Oui</span>
                                    <br>
                                    <span>Cauffage coll.:</span> <span ng-if="element.GCHCLC === 'O'">Oui</span> <span ng-if="element.GCHCLC === 'N'">Oui</span>
                                    <br>
                                    <span>Tout à l'égout:</span> <span ng-if="element.GTEGLC === 'O'">Oui</span> <span ng-if="element.GTEGLC === 'N'">Oui</span>
                                    <br>
                                    <span>Baignoire(s):</span> <span>{{parseFloat(element.DNBBAI)}}</span>
                                    <br>
                                    <span>Douche(s):</span> <span>{{parseFloat(element.DNBDOU)}}</span>
                                    <br>
                                    <span>Lavabo(s):</span> <span>{{parseFloat(element.DNBLAV)}}</span>
                                    <br>
                                    <span>Toilette(s):</span> <span>{{parseFloat(element.DNBWC)}}</span>
                                </td>
                                <!-- Divers -->
                                <td>
                                    <span>Surface: </span><span>{{parseFloat(element.DSUPDC)}}</span>m²
                                    <br>
                                    <span>Nombre de pièces: </span><span>{{parseFloat(element.DNBPDC)}}</span>
                                    <br>
                                    <span>Nombre de pièces principales: </span><span>{{parseFloat(element.DNBPPR)}}</span>
                                    <br>
                                    <span>Entretien: </span><span>{{element.L_DETENT}}</span>
                                    <br>
                                    <span>Année d'achèvement: </span><span>{{element.JANNAT}}</span>
                                    <br>
                                    <span>Nombre de niveaux: </span><span>{{parseFloat(element.DNBNIV)}}</span>
                                    <br>
                                    <span>Toitures: </span><span>{{element.L_DMATTO}}</span>
                                    <br>
                                    <span>Gros murs: </span><span>{{element.L_DMATGM}}</span>
                                </td>
                                <!-- Pièces(s) -->
                                <td>
                                    <span>Salle(s) à manger: </span> {{parseFloat(element.DNBSAM)}}
                                    <br>
                                    <span>Chambre(s): </span> {{parseFloat(element.DNBCHA)}}
                                    <br>
                                    <span>Cuisine(s): </span> {{parseFloat(element.DNBCU8) + parseFloat(element.DNBCU9)}}
                                    <br>
                                    <span>Salle(s) d'eau: </span> {{parseFloat(element.DNBSEA)}}
                                    <br>
                                    <span>Annexe(s): </span> {{parseFloat(element.DNBANN)}}
                                </td>
                                <!-- Annexe(s) -->
                                <td>
                                    <div ng-if="element.L_CCONAD1 && trim(element.L_CCONAD1) !== ''">{{element.L_CCONAD1}}: {{element.DSUEIC1}}</div>
                                    <div ng-if="element.L_CCONAD2 && trim(element.L_CCONAD2) !== ''">{{element.L_CCONAD2}}: {{element.DSUEIC2}}</div>
                                    <div ng-if="element.L_CCONAD3 && trim(element.L_CCONAD3) !== ''">{{element.L_CCONAD3}}: {{element.DSUEIC3}}</div>
                                    <div ng-if="element.L_CCONAD4 && trim(element.L_CCONAD4) !== ''">{{element.L_CCONAD4}}: {{element.DSUEIC4}}</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Locaux pro -->
                <div ng-if="ctrl.oInvariant.locauxPros.length !== 0">
                    <h4>Local professionnel</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>P.E.V</th>
                                <th>Numéro d'ordre</th>
                                <th>Surface totale</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.locauxPros">
                                <td>{{parseFloat(element.DNUPEV)}}</td>
                                <td>{{element.DNUDES}}</td>
                                <td>{{parseFloat(element.VSURZT)}}m²</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Dépendances -->
                <div ng-if="ctrl.oInvariant.dependances.length !== 0">
                    <h4>Dépendances</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>P.E.V</th>
                                <th>Divers</th>
                                <th>Eléments de confort</th>
                                <th>Pièces(s)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.dependances">
                                <!-- P.E.V -->
                                <td>
                                    {{parseFloat(element.DNUPEV)}}
                                </td>
                                <!-- Divers -->
                                <td>
                                    <div>Surface: {{element.DSUDEP}}m²</div>
                                    <div>Nature: {{element.L_CCONAD}}</div>
                                    <div>Entretien: {{element.L_DETENT}}</div>
                                    <div>Toitures: {{element.L_DMATTO}}</div>
                                    <div>Gros murs: {{element.L_DMATGM}}</div>
                                </td>
                                <!-- Eléments de confort -->
                                <td>
                                    <div>Eau: <span ng-if="element.GEAULC === 'O'">Oui</span>
                                        <span ng-if="element.GEAULC === 'N'">Non</span></div>
                                    <div>électicité: <span ng-if="element.GELELC === 'O'">Oui</span>
                                        <span ng-if="element.GELELC === 'N'">Non</span></div>
                                    <div>Chauffage coll.: <span ng-if="element.GCHCLC === 'O'">Oui</span>
                                        <span ng-if="element.GCHCLC === 'N'">Non</span></div>
                                </td>
                                <!-- Pièces(s) -->
                                <td>
                                    <div>Baignoire(s): {{parseFloat(element.DNBBAI)}}</div>
                                    <div>Douche(s): {{parseFloat(element.DNBDOU)}}</div>
                                    <div>Lavabo(s): {{parseFloat(element.DNBLAV)}}</div>
                                    <div>Toilette(s): {{parseFloat(element.DNBWC)}}</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Propriétaires -->
                <div ng-if="ctrl.oInvariant.proprietaires.length !== 0">
                    <h4>Propriétaire</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>Nom</th>
                                <th>Etat civil</th>
                                <th>Adresse</th>
                                <th>Indivision</th>
                                <th>Droit</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.proprietaires">
                                <td>{{element.DQUALP}} {{element.DDENOM}}</td>
                                <td >Né(e) le {{element.JDATNSS}} à {{element.DLDNSS}}</td>
                                <td>{{element.DLIGN3}} {{element.DLIGN4}} {{element.DLIGN6}}</td>
                                <td>{{element.L_CCODEM}}</td>
                                <td>{{element.L_CCODRO}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Lots -->
                <div ng-if="ctrl.oInvariant.lots.length !== 0">
                    <h4>Lot-Local</h4>
                    <table class="table font-12">
                        <thead>
                            <tr class="blue color-white">
                                <th>Identifiant d'un lot</th>
                                <th>Millièmes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="element in ctrl.oInvariant.lots">
                                <td>{{element.KLOT}}</td>
                                <td>{{element.DNUMQL}}/{{element.DDENQL}}</td>
                        </tbody>
                    </table>
                </div>


            </div>
            <div class="modal-footer" ng-if="ctrl.sketchesLenght !== 0">
                <button class="btn btn-primary left" onclick="oVmap.printElem('#descriptive-invariant-sheet-content')">
                    <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal menu releve de propriete -->
<div id="releve-propriete-modal-menu" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Relevé de propriété</h4>
            </div>
            <div class="modal-body">

                <button class="btn btn-primary" ng-click="ctrl.displayReleveDeProprieteSheetOnMap('standard', ctrl.tmpID_DNUPRO, ctrl.tmpID_PAR)">
                    Relevé de propriété standard
                </button>
                <i>(compte communal numéro {{ctrl.tmpID_DNUPRO}})</i>
                <br>
                <br>
                <button class="btn btn-primary" ng-click="ctrl.displayReleveDeProprieteSheetOnMap('tiers', ctrl.tmpID_DNUPRO, ctrl.tmpID_PAR)">
                    Relevé de propriété tiers
                </button>
                <i>(compte communal numéro {{ctrl.tmpID_DNUPRO}})</i>
                <br>
                <br>
                <button class="btn btn-primary" ng-click="ctrl.displayReleveDeProprieteSheetOnMap('parcelle', ctrl.tmpID_DNUPRO, ctrl.tmpID_PAR)">
                    Relevé de propriété de la parcelle
                </button>
                <i>(parcelle numéro {{ctrl.tmpID_PAR}})</i>
            </div>
        </div>
    </div>
</div>