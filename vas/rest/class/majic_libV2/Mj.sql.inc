<?php


$aSql['pgsql']['proprietaire']= 'SELECT  id_dnupro, dnupro, id_pro, l_ccodro, l_ccodem, dnuper, dqualp, ddenom, dnomlp, dprnlp, epxnee, dnomcp, dprncp, jdatnss, dldnss, dlign3, dlign4, dlign5, dlign6, gtoper FROM s_majic.proprietaire LEFT JOIN s_majic.tc_ccodro_code_droit ON proprietaire.ccodro=tc_ccodro_code_droit.ccodro LEFT JOIN s_majic.tc_ccodem_nature_demembrement ON proprietaire.ccodem=tc_ccodem_nature_demembrement.ccodem WHERE id_dnupro=\'$sIdDnupro\' AND id_pro=\'$sIdPro\'';
$aSql['pgsql']['bati'] = 'SELECT fantoir_commune.libcom, bati_0010_local.dnbniv, bati_0010_local.jdatat, bati_0010_local.jannat, bati_0010_local.dnatlc, bati_0010_local.id_dnupro as b_iddnupro, bati_0010_local.dnupro as b_dnupro, bati_0010_local.id_local, bati_0010_local.dteloc, tc_dteloc_type_local.dteloc, bati_0010_local.dvltrt, jdatat, ccosec, dnupla, ccoplc, dnvoiri, dindic,  dvoilib, ccoriv,  dnubat, nesc, dniv, dpor, bati_0010_local. invar, ccoeva, bati_0010_local.cconlc, l_cconlc, dvlpera, gtauom, cconad,	lot_local.dnumql, lot_local.ddenql FROM s_majic.bati_0010_local LEFT JOIN s_majic.bati_60_descr_dep ON bati_0010_local.id_local=bati_60_descr_dep.id_local LEFT JOIN s_majic.bati_21_pev_descr ON bati_0010_local.id_local=bati_21_pev_descr.id_local  LEFT JOIN s_majic.tc_dteloc_type_local ON bati_0010_local.dteloc=tc_dteloc_type_local.dteloc LEFT JOIN s_majic.lot_local ON bati_0010_local.id_local=lot_local.id_local LEFT JOIN s_majic.fantoir_commune ON bati_0010_local.ccocom=fantoir_commune.ccocom LEFT JOIN s_majic."tc_cconlc_nature_local" ON bati_0010_local.cconlc="tc_cconlc_nature_local".cconlc WHERE bati_0010_local.id_local=\'$sIdBat\' ORDER BY ccosec, dnupla, bati_0010_local.invar';
$aSql['pgsql']['habit_descr'] = 'SELECT dnupev,  invar, cconad1, cconad2, cconad3, cconad4, dsueic1,  dsueic2, dsueic3, dsueic4, geaulc, gelelc, gesclc, ggazlc, gasclc, gchclc, gvorlc, gteglc, dnbbai, dnbdou,  dnblav, dnbwc, dnbppr, dnbsam, dnbcha, dnbcu8, dnbcu9, dnbsea, dnbann, dnbpdc, dsupdc, dmagtm, dmatto,  jannat, detent,  dnbniv FROM s_majic.bati_40_descr_hab WHERE id_pev=\'$sIdPev\' AND dnudes=\'$sDnudes\'';
$aSql['pgsql']['depend_descr'] = 'SELECT dnudes, dnupev,  invar, bati_60_descr_dep.cconad, tc_cconad_nature_dependance.l_cconad, dsudep, dcimlc, geaulc, geaulc, gelelc, gchclc, dnbbai, dnbdou,  dnblav, dnbwc, dmatgm, dmatto, detent FROM s_majic.bati_60_descr_dep INNER JOIN s_majic.tc_cconad_nature_dependance ON bati_60_descr_dep.cconad=tc_cconad_nature_dependance.cconad WHERE id_dep=\'$sIdDep\'';
$aSql['pgsql']['prof_descr'] = 'SELECT dnudes, dnupev,  invar, vsurzt  FROM s_majic.bati_50_descr_pro WHERE id_pev=\'$sIdPev\'';
$aSql['pgsql']['pev'] = 'SELECT bati_21_pev_descr.id_pev as id_pev, ccostb, ccoaff, dcapec, dcsglc,  bipevla1, gnexpl, dvlpera, bati_21_pev_descr.dnupev, bati_21_pev_descr.dvlper, bati_21_pev_descr.dnuref FROM s_majic.bati_21_pev_descr LEFT JOIN s_majic.bati_36_pev_tax ON bati_21_pev_descr.id_pev=bati_36_pev_tax.id_pev WHERE bati_21_pev_descr.id_pev=\'$sIdPev\'';
$aSql['pgsql']['parcelle']='SELECT  id_par,  jdatat, ccosec, dnupla, dnvoiri, dindic, cconvo,  dvoilib,typevoie, ccoriv, dparpi, gparnf, dcntpa, dnupro , gparbat FROM s_majic.nb_10_parcelle LEFT JOIN s_majic.fantoir_voie ON nb_10_parcelle.id_voie=fantoir_voie.id_voie WHERE id_par=\'$sIdPar\'';
$aSql['pgsql']['suf']='SELECT dnupro,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , id_suf, gnexps, ccostn, ccosub,nb_21_suf_descr.dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf WHERE id_suf=\'$sIdSuf\'';
$aSql['pgsql']['suf_bnd']='SELECT DISTINCT id_suf, dnupro,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , gnexps, ccostn, ccosub,nb_21_suf_descr.dsgrpf as dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub, nb_21_suf_descr.dnupdl, nb_21_suf_descr.dnulot, dnumql, ddenql FROM (s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf) LEFT JOIN s_majic.pdl_30_descr_lot ON pdl_30_descr_lot.klot=nb_21_suf_descr.klot WHERE id_suf=\'$sIdSuf\'';
$aSql['pgsql']['suf_dnupro']='SELECT nb_21_suf_descr.dnupro FROM s_majic.nb_10_parcelle RIGHT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE id_suf=\'$sIdSuf\'';
$aSql['pgsql']['compte_communal']='SELECT proprietaire.ccodep, proprietaire.ccodir, proprietaire.ccocom,  libcom, dnupro,  id_dnupro FROM s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON proprietaire.id_com=fantoir_commune.id_com WHERE id_dnupro=\'$sIdDnupro\'';
$aSql['pgsql']['bati_parcelle']='SELECT  id_par, proprietaire.ccodep, proprietaire.ccodir, proprietaire.ccocom,  libcom, proprietaire.dnupro, proprietaire.id_dnupro, nb_10_parcelle.dnvoiri, nb_10_parcelle.dindic, cconvo, dvoilib, dcntpa FROM s_majic.nb_10_parcelle INNER JOIN s_majic.proprietaire ON nb_10_parcelle.id_dnupro=proprietaire.id_dnupro LEFT JOIN s_majic.fantoir_commune ON nb_10_parcelle.id_com=fantoir_commune.id_com WHERE id_par=\'sIdPar\''; 
$aSql['pgsql']['exone_pev']='SELECT id_ex, ccolloc, gnextl, janimp, jandeb, rcexba2, pexb FROM s_majic.bati_30_pev_exo WHERE id_ex=\'$sIdEx\'';
$aSql['pgsql']['exon_suf']='SELECT id_suf, rnuexn, ccolloc, gnexts, jfinex, pexn, rcexnba FROM s_majic.nb_30_suf_exo WHERE id_suf=\'$sIdSuf\' and rnuexn=\'$sRnuexn\'';
$aSql['pgsql']['lot_local']='SELECT id_local , klot, dnupdl, dnulot, dnumql, ddenql FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' and klot"=\'$sKlot\'';
$aSql['pgsql']['get_id_pev']='SELECT id_pev FROM s_majic.bati_21_pev_descr WHERE id_local=\'$sIdBat\' ORDER BY id_pev';
$aSql['pgsql']['get_id_ex_pev']='SELECT id_ex FROM s_majic.bati_30_pev_exo WHERE id_pev=\'$sIdPev\' ORDER BY id_ex';
$aSql['pgsql']['get_id_descr_hab']='SELECT dnudes, id_pev as id_pev FROM s_majic.bati_40_descr_hab WHERE id_pev=\'$sIdPev\' ORDER BY dnudes';
$aSql['pgsql']['get_id_descr_depend']='SELECT id_dep FROM s_majic.bati_60_descr_dep WHERE id_pev=\'$sIdPev\' ORDER BY "id_dep"';
$aSql['pgsql']['get_klot']='SELECT klot FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' ORDER BY klot';
$aSql['pgsql']['get_id_suf']='SELECT id_suf FROM s_majic.nb_10_parcelle RIGHT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE (nb_10_parcelle.dnupro=\'sDnupro\' OR nb_21_suf_descr.dnupro=\'sDnupro\') AND nb_21_suf_descr.id_par=\'sIdPar\' AND (nb_10_parcelle.id_dnupro=\'sIdDnupro\' OR nb_21_suf_descr.dnupro=\'sDnupro\')';
$aSql['pgsql']['get_rnuexn']='SELECT DISTINCT rnuexn FROM s_majic.nb_30_suf_exo WHERE id_suf=\'$sIdSuf\' ORDER BY rnuexn';
$aSql['pgsql']['get_id_pro']='SELECT DISTINCT id_pro FROM s_majic.proprietaire WHERE id_dnupro=\'$sIdDnupro\' ORDER BY id_pro';
$aSql['pgsql']['get_id_bat']='SELECT id_local FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' ORDER BY id_local';
$aSql['pgsql']['get_id_par']='SELECT DISTINCT nb_10_parcelle.id_par FROM s_majic.nb_10_parcelle LEFT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE (nb_10_parcelle.dnupro=\'$sDnupro\' OR nb_21_suf_descr.dnupro=\'$sDnupro\') AND nb_21_suf_descr.id_com=\'$sIdCom\' ORDER BY nb_10_parcelle.id_par';
$aSql['pgsql']['get_id_par_bnd']='SELECT nb_10_parcelle.id_par FROM s_majic.nb_21_suf_descr INNER JOIN s_majic.nb_10_parcelle ON nb_21_suf_descr.id_par = nb_10_parcelle.id_par WHERE nb_21_suf_descr.dnupro = \'$sDnupro\' AND nb_10_parcelle.id_dnupro != \'$sIdDnupro\' AND nb_10_parcelle.id_com=\'sIdCom\'';
$aSql['pgsql']['get_par_id_bat']='SELECT id_local as id_bat FROM s_majic.bati_0010_local WHERE id_par=\'sIdPar\' ORDER BY id_local';
$aSql['pgsql']['annee_reference']='SELECT annee FROM s_majic.annee_reference';
$aSql['pgsql']['get_id_dnupro']='SELECT  id_dnupro as iddnupro, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'idparpro\'';
$aSql['pgsql']['compte_communal_parcelle']='SELECT proprietaire.ccodep , libdep, proprietaire.ccodir, proprietaire.ccocom ,  libcom, proprietaire.dnupro, proprietaire.id_dnupro,  id_par FROM s_majic.nb_10_parcelle, s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON proprietaire.id_com=fantoir_commune.id_com LEFT JOIN s_majic.fantoir_direction ON fantoir_commune.ccodep= fantoir_direction.ccodep WHERE proprietaire.id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\''; 
$aSql['pgsql']['get_id_bat_parcelle']='SELECT id_local as id_bat FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\' ORDER BY id_local';
/*$aSql['pgsql']['emprise']['bati']='SELECT  id_par,  jdatat, ccosec, dnupla, dnvoiri, dindic, cconvo,  dvoilib, ccoriv, dparpi, gparnf, dcntpa, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'$sIdPar\'';
$aSql['pgsql']['emprise']['pos']='SELECT  id_par,  jdatat, ccosec, dnupla, dnvoiri, dindic, cconvo,  dvoilib, ccoriv, dparpi, gparnf, dcntpa, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'$sIdPar\'';
$aSql['pgsql']['emprise']['plu']='SELECT  id_par,  jdatat, ccosec, dnupla, dnvoiri, dindic, cconvo,  dvoilib, ccoriv, dparpi, gparnf, dcntpa, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'$sIdPar\'';
*/









$aSql['oci']['proprietaire']= 'SELECT  id_dnupro, dnupro, id_pro, l_ccodro, l_ccodem, dnuper, dqualp, ddenom, dnomlp, dprnlp, epxnee, dnomcp, dprncp, TO_CHAR(jdatnss , \'DD/MM/YYYY\') as "jdatnss", dldnss, dlign3, dlign4, dlign5, dlign6, gtoper FROM s_majic.proprietaire LEFT JOIN s_majic.tc_ccodro_code_droit ON proprietaire.ccodro=tc_ccodro_code_droit.ccodro LEFT JOIN s_majic.tc_ccodem_nature_demembrement ON proprietaire.ccodem=tc_ccodem_nature_demembrement.ccodem WHERE id_dnupro=\'$sIdDnupro\' AND id_pro=\'$sIdPro\'';
$aSql['oci']['bati'] = 'SELECT fantoir_commune.libcom, bati_0010_local. dnbniv, TO_CHAR(bati_0010_local.jdatat , \'DD/MM/YYYY\') as "jdatat", bati_0010_local.jannat, bati_0010_local.dnatlc, bati_0010_local.id_dnupro, bati_0010_local.dnupro as "b_dnupro", bati_0010_local.id_local as "id_local", bati_0010_local.dteloc, tc_dteloc_type_local.dteloc, bati_0010_local.dvltrt, ccosec, dnupla, ccoplc, dnvoiri, dindic,  dvoilib, ccoriv, dnubat, nesc, dniv, dpor, bati_0010_local.invar, ccoeva, tc_cconlc_nature_local.cconlc as cconlc, dvlpera, gtauom, cconad, lot_local.id_local as "Local_id_bat",lot_local.dnumql,lot_local.ddenql, l_cconlc FROM s_majic.bati_0010_local LEFT JOIN s_majic.bati_60_descr_dep ON bati_0010_local.id_local=bati_60_descr_dep.id_local LEFT JOIN s_majic.bati_21_pev_descr ON bati_0010_local.id_local=bati_21_pev_descr.id_local  LEFT JOIN s_majic.tc_dteloc_type_local ON bati_0010_local.dteloc=tc_dteloc_type_local.dteloc left JOIN s_majic.lot_local on bati_0010_local.id_local =lot_local.id_local left JOIN s_majic.fantoir_commune on bati_0010_local.id_com =fantoir_commune.id_com LEFT JOIN s_majic.tc_cconlc_nature_local ON bati_0010_local.cconlc=tc_cconlc_nature_local.cconlc  WHERE bati_0010_local.id_local=\'$sIdBat\' ORDER BY ccosec, dnupla,bati_0010_local.invar';
$aSql['oci']['habit_descr'] = 'SELECT dnupev,  invar, cconad1, cconad2, cconad3, cconad4, dsueic1,  dsueic2, dsueic3, dsueic4, geaulc, gelelc, gesclc, ggazlc, gasclc, gchclc, gvorlc, gteglc, dnbbai, dnbdou,  dnblav, dnbwc, dnbppr, dnbsam, dnbcha, dnbcu8, dnbcu9, dnbsea, dnbann, dnbpdc, dsupdc,tc_dmatgm_materiaux_gros_murs.dmatgm, tc_dmatto_materiaux_toitures.dmatto, jannat, bati_40_descr_hab.detent, l_detent,  dnbniv, tc_dmatgm_materiaux_gros_murs.l_dmatgm, tc_dmatto_materiaux_toitures.l_dmatto FROM s_majic.bati_40_descr_hab LEFT JOIN s_majic.tc_detent_etat_entretien ON bati_40_descr_hab.detent=tc_detent_etat_entretien.detent LEFT JOIN s_majic.tc_dmatgm_materiaux_gros_murs ON bati_40_descr_hab.dmatgm=tc_dmatgm_materiaux_gros_murs.dmatgm LEFT JOIN s_majic.tc_dmatto_materiaux_toitures ON bati_40_descr_hab.dmatto=tc_dmatto_materiaux_toitures.dmatto WHERE id_pev=\'$sIdPev\'';
$aSql['oci']['depend_descr'] = 'SELECT dnudes, dnupev, invar, cconad, dsudep, dcimlc, geaulc, gelelc, gchclc, dnbbai, dnbdou,  dnblav, dnbwc, tc_dmatgm_materiaux_gros_murs.dmatgm, tc_dmatto_materiaux_toitures.dmatto, bati_60_descr_dep.detent, l_detent, tc_dmatgm_materiaux_gros_murs.l_dmatgm, tc_dmatto_materiaux_toitures.l_dmatto  FROM s_majic.bati_60_descr_dep LEFT JOIN s_majic.tc_detent_etat_entretien ON bati_60_descr_dep.detent=tc_detent_etat_entretien.detent LEFT JOIN s_majic.tc_dmatgm_materiaux_gros_murs ON bati_60_descr_dep.dmatgm=tc_dmatgm_materiaux_gros_murs.dmatgm LEFT JOIN s_majic.tc_dmatto_materiaux_toitures ON bati_60_descr_dep.dmatto=tc_dmatto_materiaux_toitures.dmatto WHERE id_pev=\'$sIdPev\'';
$aSql['oci']['prof_descr'] = 'SELECT dnudes, dnupev,  invar, vsurzt  FROM s_majic.bati_50_descr_pro WHERE id_pev=\'$sIdPev\'';
$aSql['oci']['pev'] = 'SELECT  bati_21_pev_descr.id_pev as id_pev, ccostb, bati_21_pev_descr.ccoaff, l_ccoaff, dcapec, dcsglc, bipevla1, bati_21_pev_descr.gnexpl, l_gnexpl, dvlpera, bati_21_pev_descr.dnupev, bati_21_pev_descr.dvlper, bati_21_pev_descr.dnuref FROM s_majic.bati_21_pev_descr LEFT JOIN s_majic.tc_ccoaff_affectation_pev ON bati_21_pev_descr.ccoaff=tc_ccoaff_affectation_pev.ccoaff LEFT JOIN s_majic.tc_gnexpl_exoneration_permanente ON bati_21_pev_descr.gnexpl=tc_gnexpl_exoneration_permanente.gnexpl LEFT JOIN s_majic.bati_36_pev_tax ON bati_21_pev_descr.id_pev=bati_36_pev_tax.id_pev WHERE bati_21_pev_descr.id_pev=\'$sIdPev\'';
$aSql['oci']['parcelle']='SELECT  id_par,  jdatat, ccosec, dnupla, dnvoiri, dindic,  codevoie, libvoie,typevoie, ccoriv, dparpi, gparnf, Ltrim(TO_CHAR(DCNTPA, \'000000000\')) as dcntpa, dnupro, gparbat, gurbpa FROM s_majic.nb_10_parcelle LEFT JOIN s_majic.fantoir_voie ON nb_10_parcelle.id_voie=fantoir_voie.id_voie WHERE id_par=\'$sIdPar\' ORDER BY ccosec,dnupla';
$aSql['oci']['suf']='SELECT dnupro,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , id_suf, gnexps, ccostn, ccosub,nb_21_suf_descr.dsgrpf as dsgrpf, l_dsgrpf, dclssf, cnatsp, Ltrim(TO_CHAR(dcntsf, \'000000000\')) as dcntsf, drcsuba, drcsub,nb_21_suf_descr.cgrnum, l_cgrnum FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf LEFT JOIN s_majic.tc_cgrnum_groupe_numerique ON nb_21_suf_descr.cgrnum = tc_cgrnum_groupe_numerique.cgrnum WHERE id_suf=\'$sIdSuf\'';
$aSql['oci']['suf_bnd']='SELECT DISTINCT id_suf,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , dnupro, gnexps, ccostn, ccosub, nb_21_suf_descr.dsgrpf, l_dsgrpf, dclssf, cnatsp, Ltrim(TO_CHAR(dcntsf, \'000000000\')) as dcntsf, drcsuba, drcsub, nb_21_suf_descr.dnupdl, nb_21_suf_descr.dnulot, dnumql, ddenql,nb_21_suf_descr.cgrnum, l_cgrnum FROM (s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf) LEFT JOIN s_majic.tc_cgrnum_groupe_numerique ON nb_21_suf_descr.cgrnum = tc_cgrnum_groupe_numerique.cgrnum LEFT JOIN s_majic.pdl_30_descr_lot ON pdl_30_descr_lot.klot=nb_21_suf_descr.klot WHERE id_suf=\'$sIdSuf\' AND dnupro = \'sIdDnupro\'';
$aSql['oci']['suf_bnd_all']='SELECT DISTINCT id_suf, dnupro,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , gnexps, ccostn, ccosub, nb_21_suf_descr.dsgrpf as dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub, dnupdl, dnulot, nb_21_suf_descr.cgrnum, l_cgrnum FROM s_majic.nb_21_suf_descr LEFT JOIN tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf LEFT JOIN tc_cgrnum_groupe_numerique ON nb_21_suf_descr.CGRNUM = tc_cgrnum_groupe_numerique.cgrnum WHERE id_suf=\'$sIdSuf\'';
$aSql['oci']['suf_dnupro']='SELECT nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as dnupro FROM s_majic.nb_10_parcelle RIGHT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE id_suf=\'$sIdSuf\'';
$aSql['oci']['compte_communal']='SELECT proprietaire.ccodep as ccodep, proprietaire.ccodir, proprietaire.ccocom as ccocom,  libcom, dnupro,  id_dnupro FROM s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON proprietaire.id_com=fantoir_commune.id_com WHERE id_dnupro=\'$sIdDnupro\'';
$aSql['oci']['exone_pev']='SELECT id_ex, ccolloc, gnextl, janimp, jandeb, rcexba2, pexb FROM s_majic.bati_30_pev_exo WHERE id_ex=\'$sIdEx\'';
$aSql['oci']['exon_suf']='SELECT id_suf, rnuexn, ccolloc, gnexts, jfinex, pexn, rcexnba FROM s_majic.nb_30_suf_exo WHERE id_par=(substr(\'$sIdSuf\',0,15)) AND ccosub=(substr(\'$sIdSuf\',16)) and rnuexn=\'$sRnuexn\'';
$aSql['oci']['lot_local']='SELECT id_local, klot, dnupdl, dnulot, dnumql, ddenql FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' and klot"=\'$sKlot\'';
$aSql['oci']['get_id_pev']='SELECT id_pev FROM s_majic.bati_21_pev_descr WHERE id_local=\'$sIdBat\' ORDER BY id_pev';
$aSql['oci']['get_id_ex_pev']='SELECT id_ex FROM s_majic.bati_30_pev_exo WHERE id_pev=\'$sIdPev\' ORDER BY id_ex';
$aSql['oci']['get_klot']='SELECT klot FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' ORDER BY klot';
$aSql['oci']['get_id_suf']='SELECT id_suf FROM s_majic.nb_10_parcelle RIGHT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE (nb_10_parcelle.dnupro=\'sIdDnupro\' OR nb_21_suf_descr.dnupro=\'$sDnupro\') AND nb_21_suf_descr.id_par=\'$sIdPar\' AND (nb_10_parcelle.id_dnupro=\'$sIdDnupro\' OR nb_21_suf_descr."DNUPRO"=\'$sDnupro\')';
$aSql['oci']['get_rnuexn']='SELECT DISTINCT rnuexn FROM s_majic.nb_30_suf_exo WHERE id_par=(substr(\'$sIdSuf\',0,15)) AND ccosub=(substr(\'$sIdSuf\',16)) ORDER BY rnuexn';
$aSql['oci']['get_id_pro']='SELECT DISTINCT id_pro, dnuper FROM s_majic.proprietaire WHERE id_dnupro=\'$sIdDnupro\' ORDER BY dnuper';
$aSql['oci']['get_id_bat']='SELECT id_local FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' ORDER BY id_local';
$aSql['oci']['get_id_par']='SELECT DISTINCT nb_10_parcelle.id_par FROM s_majic.nb_10_parcelle LEFT JOIN s_majic.nb_21_suf_descr ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE (nb_10_parcelle.dnupro=\'$sDnupro\' OR nb_21_suf_descr.dnupro=\'$sDnupro\') AND nb_21_suf_descr.id_com=\'$sIdCom\' ORDER BY nb_10_parcelle.id_par';
$aSql['oci']['get_id_par_bnd']='SELECT nb_10_parcelle.id_par FROM s_majic.nb_21_suf_descr INNER JOIN s_majic.nb_10_parcelle ON nb_21_suf_descr.id_par = nb_10_parcelle.id_par where nb_21_suf_descr.dnupro = \'$sDnupro\' AND nb_10_parcelle.id_dnupro != \'$sIdDnupro\' AND nb_10_parcelle.id_com=\'$sIdCom\'';
$aSql['oci']['annee_reference']='SELECT annee FROM s_majic.annee_reference';
$aSql['oci']['get_id_dnupro']='SELECT  id_dnupro, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'$sidparpro\'';
$aSql['oci']['compte_communal_parcelle']='SELECT fantoir_commune.id_com ,proprietaire.ccodep, libdep, proprietaire.ccodir, fantoir_commune.ccocom,  libcom, proprietaire.dnupro,proprietaire.id_dnupro, id_par FROM s_majic.nb_10_parcelle, s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON proprietaire.id_com=fantoir_commune.id_com LEFT JOIN s_majic.fantoir_direction ON fantoir_commune.ccodep= fantoir_direction.ccodep WHERE proprietaire.id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\'';
$aSql['oci']['get_id_bat_parcelle']='SELECT id_local as id_local FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\' ORDER BY id_local';
$aSql['oci']['get_par_id_bat']='SELECT id_local as id_local FROM s_majic.bati_0010_local WHERE id_par=\'sIdPar\' ORDER BY id_local';
$aSql['oci']['pos_plu']='SELECT p.GGCODEIDENT, cos, ces, type, hauteur, libelle, SDO_GEOM.SDO_AREA (SDO_GEOM.SDO_INTERSECTION(z.GEOM, p.GEOM, 0.005),0.005) surface  FROM exp_pos.zpos_simpl z RIGHT join cadastre.parcelle_cadastrale_mixee p  ON SDO_RELATE (z.geom,p.geom, \'mask=CONTAINS+INSIDE+OVERLAPBDYINTERSECT+COVERS+COVEREDBY+EQUAL querytype=WINDOW\') = \'TRUE\'  AND z.codcom =p.codcom WHERE z.OBJECTID = \'$sObjectId\' AND p.PAR_ID = \'$sIdPar\' AND p.codcom = \'$sCodCom\' and SDO_GEOM.SDO_AREA (SDO_GEOM.SDO_INTERSECTION(z.GEOM, p.GEOM, 0.005),0.005) >2';
$aSql['oci']['get_id_pos_plu']='SELECT z.OBJECTID  FROM exp_pos.zpos_simpl z, cadastre.parcelle_cadastrale_mixee p  WHERE SDO_RELATE (z.geom,p.geom, \'mask=CONTAINS+INSIDE+OVERLAPBDYINTERSECT+COVERS+COVEREDBY+EQUAL querytype=WINDOW`\') = \'TRUE\'  AND z.codcom=p.codcom AND p.PAR_ID = \'$sIdPar\' AND p.codcom = \'$sCodCom\'';
$aSql['oci']['get_codcom']='SELECT nb_10_parcelle.id_com FROM s_maJIC.nb_10_parcelle WHERE (nb_10_parcelle.id_par =\'$sIdPar\')';









$aSql['sqlite']['proprietaire']= 'SELECT  id_dnupro, dnupro, id_pro, l_ccodro, l_ccodem, dnuper, dqualp, ddenom, dnomlp, dprnlp,epxnee, dnomcp, dprncp, jdatnss, dldnss, dlign3, dlign4, dlign5, dlign6, gtoper FROM s_majic.proprietaire LEFT JOIN s_majic.tc_ccodro_code_droit ON proprietaire.ccodro=tc_ccodro_code_droit.ccodro LEFT JOIN s_majic.tc_ccodem_nature_demembrement ON proprietaire.ccodem=tc_ccodem_nature_demembrement.ccodem WHERE id_dnupro=\'$sIdDnupro\' AND id_pro=\'$sIdPro\'';
//modif pas faites sur autre database
$aSql['sqlite']['bati'] = 'SELECT fantoir_commune.libcom, bati_0010_local.dnbniv, bati_0010_local.jdatat, bati_0010_local.jannat, bati_0010_local.dnatlc, bati_0010_local.id_dnupro, bati_0010_local.dnupro as b_dnupro, bati_0010_local.id_local as id_bat, bati_0010_local.dteloc, tc_dteloc_type_local.dteloc, bati_0010_local.dvltrt, jdatat, ccosec, dnupla, ccoplc, dnvoiri, dindic,  dvoilib, ccoriv, dnubat, nesc, dniv, dpor, bati_0010_local.invar, ccoeva, tc_cconlc_nature_local.cconlc, dvlpera, gtauom, cconad, lot_local.id_local as Local_id_bat, lot_local.dnumql, lot_local.ddenql, l_cconlc FROM s_majic.bati_0010_local LEFT JOIN s_majic.bati_60_descr_dep ON bati_0010_local.id_local=bati_60_descr_dep.id_local LEFT JOIN s_majic.bati_21_pev_descr ON bati_0010_local.id_local=bati_21_pev_descr.id_local  LEFT JOIN s_majic.tc_dteloc_type_local ON bati_0010_local.dteloc=tc_dteloc_type_local.dteloc LEFT JOIN s_majic.lot_local ON s_majic.bati_0010_local.id_local =lot_local.id_local LEFT JOIN s_majic.fantoir_commune ON s_majic.bati_0010_local.ccocom =fantoir_commune.ccocom LEFT JOIN s_majic.tc_cconlc_nature_local ON bati_0010_local.cconlc=tc_cconlc_nature_local.cconlc  WHERE bati_0010_local.id_local=\'$sIdBat\' ORDER BY ccosec, dnupla,bati_0010_local.invar';
$aSql['sqlite']['habit_descr'] = 'SELECT dnupev,  invar, cconad1, cconad2, cconad3, cconad4, dsueic1,  dsueic2, dsueic3, dsueic4, geaulc, gelelc, gesclc, ggazlc, gasclc, gchclc, gvorlc, gteglc, dnbbai, dnbdou,  dnblav, dnbwc, dnbppr, dnbsam, dnbcha, dnbcu8, dnbcu9, dnbsea, dnbann, dnbpdc, dsupdc, tc_dmatgm_materiaux_gros_murs.dmatgm, tc_dmatto_materiaux_toitures.dmatto, jannat, bati_40_descr_hab.detent, l_detent,  dnbniv, tc_dmatgm_materiaux_gros_murs.l_dmatgm, tc_dmatto_materiaux_toitures.l_dmatto FROM s_majic.bati_40_descr_hab LEFT JOIN s_majic.tc_detent_etat_entretien ON bati_40_descr_hab.detent=tc_detent_etat_entretien.detent LEFT JOIN s_majic.tc_dmatgm_materiaux_gros_murs ON bati_40_descr_hab.dmatgm=tc_dmatgm_materiaux_gros_murs.dmatgm LEFT JOIN s_majic.tc_dmatto_materiaux_toitures ON bati_40_descr_hab.dmatto=tc_dmatto_materiaux_toitures.dmatto WHERE id_pev=\'$sIdPev\'';
$aSql['sqlite']['depend_descr'] = 'SELECT dnudes, dnupev,  invar, cconad, dsudep, dcimlc, geaulc, geaulc, gelelc, gchclc, dnbbai, dnbdou,  dnblav, dnbwc, tc_dmatgm_materiaux_gros_murs.dmatgm, tc_dmatto_materiaux_toitures.dmatto, bati_60_descr_dep.detent, l_detent, tc_dmatgm_materiaux_gros_murs.l_dmatgm, tc_dmatto_materiaux_toitures.l_dmatto FROM s_majic.bati_60_descr_dep LEFT JOIN s_majic.tc_detent_etat_entretien ON bati_60_descr_dep.detent=tc_detent_etat_entretien.detent LEFT JOIN s_majic.tc_dmatgm_materiaux_gros_murs ON bati_60_descr_dep.dmatgm=tc_dmatgm_materiaux_gros_murs.dmatgm LEFT JOIN s_majic.tc_dmatto_materiaux_toitures ON bati_60_descr_dep.dmatto=tc_dmatto_materiaux_toitures.dmatto WHERE id_pev=\'$sIdPev\'';
$aSql['sqlite']['prof_descr'] = 'SELECT dnudes, dnupev,  invar, vsurzt  FROM s_majic.bati_50_descr_pro WHERE id_pev=\'$sIdPev\'';
$aSql['sqlite']['pev'] = 'SELECT  bati_21_pev_descr.id_pev as id_pev, ccostb, bati_21_pev_descr.ccoaff, l_ccoaff, dcapec, dcsglc,  bipevla1, bati_21_pev_descr.gnexpl, l_gnexpl, dvlpera, bati_21_pev_descr.dnupev, bati_21_pev_descr.dvlper, bati_21_pev_descr.dnuref FROM s_majic.bati_21_pev_descr LEFT JOIN s_majic.tc_ccoaff_affectation_pev ON bati_21_pev_descr.ccoaff=tc_ccoaff_affectation_pev.ccoaff LEFT JOIN s_majic.tc_gnexpl_exoneration_permanente ON bati_21_pev_descr.gnexpl=tc_gnexpl_exoneration_permanente.gnexpl LEFT JOIN s_majic.bati_36_pev_tax ON s_majic.bati_21_pev_descr.id_pev=bati_36_pev_tax.id_pev  WHERE bati_21_pev_descr.id_pev=\'$sIdPev\'';
//fin modif
$aSql['sqlite']['parcelle']='SELECT  id_par, jdatat, ccosec, dnupla, dnvoiri, dindic, codevoie, libvoie,typevoie, ccoriv, dparpi, gparnf, dcntpa, dnupro , gparbat FROM s_majic.nb_10_parcelle LEFT JOIN s_majic.fantoir_voie ON nb_10_parcelle.id_voie=fantoir_voie.id_voie WHERE id_par=\'$sIdPar\' ORDER BY ccosec,dnupla';
//modif
$aSql['sqlite']['suf']='SELECT DISTINCT dnupro,nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , id_suf, gnexps, ccostn, ccosub,nb_21_suf_descr.dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub, nb_21_suf_descr.cgrnum, l_cgrnum FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf LEFT JOIN s_majic.tc_cgrnum_groupe_numerique ON nb_21_suf_descr.cgrnum = tc_cgrnum_groupe_numerique.cgrnum WHERE id_suf=\'$sIdSuf\'';
$aSql['sqlite']['suf_bnd']='SELECT DISTINCT id_suf, dnupro, nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro, gnexps, ccostn, ccosub, nb_21_suf_descr.dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub, dnupdl, dnulot, nb_21_suf_descr.cgrnum, l_cgrnum FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf LEFT JOIN s_majic.tc_cgrnum_groupe_numerique ON nb_21_suf_descr.cgrnum = tc_cgrnum_groupe_numerique.cgrnum WHERE id_suf=\'$sIdSuf\' AND dnupro = \'sIdDnupro\'';
$aSql['sqlite']['suf_bnd_all']='SELECT DISTINCT id_suf, dnupro, nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro , gnexps, ccostn, ccosub, nb_21_suf_descr.dsgrpf, l_dsgrpf, dclssf, cnatsp, dcntsf, drcsuba, drcsub, dnupdl, dnulot, nb_21_suf_descr.cgrnum, l_cgrnum FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.tc_dsgrpf_sousgroupe_suf ON nb_21_suf_descr.dsgrpf = tc_dsgrpf_sousgroupe_suf.dsgrpf LEFT JOIN s_majic.tc_cgrnum_groupe_numerique ON nb_21_suf_descr.cgrnum = tc_cgrnum_groupe_numerique.cgrnum WHERE id_suf=\'$sIdSuf\'';
//fin modif
$aSql['sqlite']['compte_communal']='SELECT proprietaire.ccodep, proprietaire.ccodir, proprietaire.ccocom,  libcom, dnupro,  id_dnupro FROM s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON proprietaire.id_com=fantoir_commune.id_com WHERE id_dnupro=\'$sIdDnupro\'';
$aSql['sqlite']['exone_pev']='SELECT id_ex, ccolloc,  gnextl,  janimp,  jandeb, rcexba2, pexb FROM s_majic.bati_30_pev_exo WHERE id_ex=\'$sIdEx\'';
$aSql['sqlite']['exon_suf']='SELECT id_suf, rnuexn, ccolloc, gnexts, jfinex, pexn, rcexnba FROM s_majic.nb_30_suf_exo WHERE id_suf=\'$sIdSuf\' and rnuexn=\'$sRnuexn\'';
$aSql['sqlite']['lot_local']='SELECT id_local as id_bat, klot, dnupdl, dnulot FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' and klot=\'$sKlot\'';
$aSql['sqlite']['get_id_pev']='SELECT id_pev as id_pev FROM s_majic.bati_21_pev_descr WHERE id_local=\'$sIdBat\' ORDER BY id_pev';
$aSql['sqlite']['get_id_ex_pev']='SELECT id_ex FROM s_majic.bati_30_pev_exo WHERE id_pev=\'$sIdPev\' ORDER BY id_ex';
$aSql['sqlite']['get_klot']='SELECT klot FROM s_majic.lot_local WHERE id_local=\'$sIdBat\' ORDER BY klot';
//modif
$aSql['sqlite']['get_id_suf']='SELECT DISTINCT id_suf FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.nb_10_parcelle ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE nb_21_suf_descr.id_par=\'$sIdPar\' AND (nb_10_parcelle.id_dnupro=\'$sIdDnupro\' OR nb_21_suf_descr.dnupro=\'$sDnupro\')';
$aSql['sqlite']['suf_dnupro']='SELECT nb_21_suf_descr.ccodep || nb_21_suf_descr.ccocom || nb_21_suf_descr.dnupro as id_dnupro FROM s_majic.nb_21_suf_descr LEFT JOIN s_majic.nb_10_parcelle ON nb_10_parcelle.id_par=nb_21_suf_descr.id_par WHERE id_suf=\'$sIdSuf\'';
//fin modif
$aSql['sqlite']['get_rnuexn']='SELECT DISTINCT rnuexn FROM s_majic.nb_30_suf_exo WHERE id_suf=\'$sIdSuf\' ORDER BY rnuexn';
$aSql['sqlite']['get_id_pro']='SELECT DISTINCT id_pro FROM s_majic.proprietaire WHERE id_dnupro=\'$sIdDnupro\' ORDER BY id_pro';
$aSql['sqlite']['get_id_bat']='SELECT id_local as id_bat FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' ORDER BY id_local';
$aSql['sqlite']['get_id_par']='SELECT  id_par FROM s_majic.nb_10_parcelle WHERE  id_com=\'sIdCom\' AND id_dnupro=\'sDnupro\' ORDER BY nb_10_parcelle.id_par';
$aSql['sqlite']['get_id_par_bnd']='SELECT nb_10_parcelle.id_par FROM s_majic.nb_21_suf_descr INNER JOIN s_majic.nb_10_parcelle ON nb_21_suf_descr.id_par = nb_10_parcelle.id_par WHERE nb_21_suf_descr.dnupro = \'$sDnupro\' AND nb_10_parcelle.id_dnupro != \'$sIdDnupro\' AND nb_10_parcelle.id_com=\'$sIdCom\'';
$aSql['sqlite']['annee_reference']='SELECT annee FROM s_majic.annee_reference';
$aSql['sqlite']['get_id_dnupro']='SELECT  id_dnupro, dnupro FROM s_majic.nb_10_parcelle WHERE id_par=\'$sidparpro\'';
$aSql['sqlite']['compte_communal_parcelle']='SELECT fantoir_commune.id_com, proprietaire.ccodep, libdep, proprietaire. ccodir, fantoir_commune.ccocom, libcom, proprietaire.dnupro, proprietaire.id_dnupro, id_par FROM s_majic.nb_10_parcelle, s_majic.proprietaire LEFT JOIN s_majic.fantoir_commune ON s_majic.proprietaire.id_com=fantoir_commune.id_com LEFT JOIN s_majic.fantoir_direction ON fantoir_commune.ccodep= fantoir_direction.ccodep WHERE proprietaire.id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\'';
$aSql['sqlite']['get_id_bat_parcelle']='SELECT id_local as id_bat FROM s_majic.bati_0010_local WHERE id_dnupro=\'$sIdDnupro\' and id_par=\'$sIdPar\' ORDER BY id_local';
$aSql['sqlite']['get_par_id_bat']='SELECT id_local as id_bat FROM s_majic.bati_0010_local WHERE id_par=\'sIdPar\' ORDER BY id_local';
?>